# تقرير: ميزات التفاعل مع المحتوى الذكي

## تاريخ التنفيذ
2025-01-01

## الميزات المضافة

### 1. أزرار التفاعل في بطاقات الأخبار
- **الإعجاب (Like)**: 
  - زر قلب يتغير لونه عند الإعجاب
  - يعرض عدد الإعجابات
  - يضيف 5 نقاط ولاء عند الإعجاب
  
- **الحفظ (Save)**:
  - زر حفظ يتغير لونه عند الحفظ
  - يضيف 3 نقاط ولاء عند الحفظ
  
- **المشاركة (Share)**:
  - زر مشاركة يعمل مع Web Share API
  - fallback لنسخ الرابط

### 2. نافذة تسجيل الدخول للزوار
- تظهر عند محاولة التفاعل بدون تسجيل دخول
- تعرض مميزات التسجيل:
  - حفظ المقالات المفضلة
  - كسب نقاط الولاء
  - الحصول على توصيات ذكية

### 3. تسجيل الانطباعات
- يتم تسجيل انطباع عند عرض المقالات للمستخدمين المسجلين
- يسجل بعد 2 ثانية من العرض
- يضيف نقطة ولاء واحدة لكل جلسة مشاهدة

### 4. API Endpoints

#### `/api/interactions`
- **POST**: إضافة أو إزالة تفاعل (إعجاب/حفظ)
- يحسب نقاط الولاء تلقائياً
- يسجل الانطباع مع التفاعل

#### `/api/interactions/check`
- **GET**: التحقق من التفاعلات السابقة
- يرجع حالة الإعجاب والحفظ

#### `/api/impressions`
- **POST**: تسجيل انطباعات متعددة دفعة واحدة
- يضيف نقاط ولاء للمشاهدة

## الملفات المحدثة

### 1. `app/page.tsx`
- إضافة NewsCard component محدث بميزات التفاعل
- إضافة useEffect لتسجيل الانطباعات
- دعم `Heart`, `Bookmark`, `LogIn` icons

### 2. `app/api/interactions/route.ts`
- معالجة تفاعلات الإعجاب والحفظ
- حساب نقاط الولاء
- تسجيل الانطباعات

### 3. `app/api/interactions/check/route.ts`
- التحقق من التفاعلات السابقة للمستخدم

### 4. `app/api/impressions/route.ts`
- تسجيل انطباعات متعددة
- إضافة نقاط ولاء للمشاهدة

## نقاط الولاء

| النشاط | النقاط |
|--------|--------|
| الإعجاب | 5 نقاط |
| الحفظ | 3 نقاط |
| المشاهدة | 1 نقطة/جلسة |

## تجربة المستخدم

### للمستخدمين المسجلين:
- يمكنهم التفاعل مباشرة مع المحتوى
- يكسبون نقاط ولاء مع كل تفاعل
- يرون تفاعلاتهم السابقة محفوظة

### للزوار غير المسجلين:
- يرون أزرار التفاعل
- عند الضغط تظهر نافذة دعوة للتسجيل
- لا يتم تسجيل انطباعات لهم

## التكامل مع الأنظمة الأخرى

1. **نظام الولاء**: احتساب النقاط تلقائياً
2. **نظام التتبع السلوكي**: تسجيل جميع التفاعلات
3. **نظام التوصيات**: استخدام التفاعلات لتحسين التوصيات

## الخطوات التالية المقترحة

1. إضافة عداد التفاعلات في الوقت الفعلي
2. إضافة إشعارات عند التفاعل
3. عرض المقالات المحفوظة في صفحة منفصلة
4. تحليلات تفصيلية للتفاعلات في لوحة التحكم 