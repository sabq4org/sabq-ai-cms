# تقرير إصلاح مشكلة الصور في بيئة الإنتاج

## المشكلة
- أخطاء 404 عند محاولة عرض الصور المرفوعة محلياً على الخادم الإنتاجي (jur3a.ai)
- الصور محفوظة في `/uploads/featured/` محلياً ولكن غير موجودة على الخادم

## الحلول المطبقة

### 1. تحديث إعدادات Next.js للصور
في `next.config.js`:
```javascript
images: {
  remotePatterns: [
    // إضافة دومين الإنتاج
    {
      protocol: 'https',
      hostname: 'jur3a.ai',
    },
    {
      protocol: 'https',
      hostname: '**.jur3a.ai',
    }
  ]
}
```

### 2. إنشاء API Route للصور
ملف جديد: `app/api/images/[...path]/route.ts`
- يخدم الصور من مجلد public/uploads
- يعيد توجيه إلى صورة افتراضية إذا لم يجد الصورة
- يضيف Cache headers للأداء

### 3. تحديث دالة getImageUrl
في `lib/utils.ts`:
- في بيئة الإنتاج، تستخدم API route بدلاً من المسار المباشر
- تحول `/uploads/featured/image.jpg` إلى `/api/images/featured/image.jpg`

### 4. تحديث Middleware
في `middleware.ts`:
- إضافة معالجة خاصة لطلبات `/uploads/`
- السماح لـ Next.js بمعالجة الملفات الثابتة

## النتيجة المتوقعة
- ✅ الصور الموجودة محلياً ستُعرض بشكل صحيح
- ✅ الصور غير الموجودة ستُعرض صورة افتراضية بدلاً من خطأ 404
- ✅ تحسين الأداء مع Cache headers
- ✅ حل مرن يعمل في بيئتي التطوير والإنتاج

## ملاحظات إضافية
1. يجب رفع الصور إلى الخادم الإنتاجي في مجلد `public/uploads`
2. أو استخدام خدمة تخزين خارجية مثل Cloudinary أو AWS S3
3. API route يوفر مرونة لإضافة معالجة الصور (تغيير الحجم، الضغط، إلخ) في المستقبل 