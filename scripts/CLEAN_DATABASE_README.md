# 🧹 سكريبت تنظيف قاعدة البيانات

## 📋 الوصف

سكريبت شامل لتنظيف قاعدة بيانات نظام Sabq AI CMS من جميع البيانات التجريبية والمؤقتة، استعداداً لإدخال البيانات الحقيقية من إدارة صحيفة "سبق".

## ⚠️ تحذير هام

**هذا السكريبت سيحذف البيانات نهائياً ولا يمكن التراجع عن العملية!**

## ✅ ما سيتم حذفه

### 1. المحتوى الرئيسي
- جميع المقالات والأخبار التجريبية
- جميع التحليلات العميقة
- جميع الجرعات اليومية ومحتوياتها

### 2. التصنيفات والتنظيم
- جميع التصنيفات الحالية
- جميع الكلمات المفتاحية
- جميع القوالب

### 3. المستخدمون والمؤلفون
- جميع المستخدمين التجريبيين
- جميع المؤلفين والمراسلين
- جميع كتّاب الرأي
- نقاط الولاء وتفضيلات المستخدمين

### 4. التفاعلات والأنشطة
- جميع التعليقات
- جميع الإعجابات
- جميع المقالات المحفوظة
- جميع التصويتات
- جميع المشاهدات
- جميع سجلات الأنشطة

### 5. البيانات الإضافية
- البلوكات الذكية
- الرسائل
- جميع التفاعلات المسجلة

## 🛑 ما لن يتم حذفه

- **المستخدمون الإداريون**: أي مستخدم بدور `admin` أو `super_admin`
- **الحسابات الإدارية**: أي حساب يحتوي بريده على كلمة "admin"

## 🚀 طريقة الاستخدام

### 1. التأكد من الصلاحيات
```bash
chmod +x scripts/clean-database-full.js
```

### 2. تشغيل السكريبت
```bash
node scripts/clean-database-full.js
```

### 3. التأكيد
- سيعرض السكريبت قائمة بما سيتم حذفه
- اكتب **"نعم"** بالعربية للتأكيد
- أي إدخال آخر سيلغي العملية

## 📊 مثال على المخرجات

```
🧹 بدء عملية تنظيف قاعدة البيانات...

⚠️  تحذير هام ⚠️
================
سيتم حذف جميع البيانات التالية نهائياً:
• جميع المقالات والأخبار
• جميع التصنيفات
• جميع المستخدمين (عدا الإداريين)
• جميع المؤلفين والمراسلين
• جميع التعليقات والتفاعلات
• جميع الجرعات اليومية
• جميع التحليلات العميقة

هل أنت متأكد من المتابعة؟ اكتب "نعم" للتأكيد: نعم

🔄 جاري تنظيف قاعدة البيانات...

📌 حذف التفاعلات والمحتوى المرتبط...
✅ تم حذف 245 تعليق
✅ تم حذف 1,234 إعجاب
✅ تم حذف 567 مقال محفوظ
...

✨ تمت عملية التنظيف بنجاح!
========================
قاعدة البيانات جاهزة الآن لإدخال البيانات الحقيقية.
تم الاحتفاظ بـ 3 مستخدم إداري فقط.
```

## 🔐 الأمان

- السكريبت يطلب تأكيداً صريحاً قبل البدء
- يعرض قائمة المستخدمين الإداريين الذين سيتم الاحتفاظ بهم
- يسجل كل عملية حذف مع عدد السجلات المحذوفة

## 🛠️ المتطلبات

- Node.js 14 أو أحدث
- اتصال فعال بقاعدة بيانات PlanetScale
- صلاحيات الحذف على قاعدة البيانات

## 📝 ملاحظات

1. **ننصح بأخذ نسخة احتياطية** قبل تشغيل السكريبت
2. السكريبت يعمل مع قاعدة بيانات PlanetScale فقط [[memory:2234480]]
3. بعد التنظيف، ستحتاج لإعادة إدخال:
   - التصنيفات الرسمية
   - المؤلفين والمراسلين الحقيقيين
   - المحتوى الرسمي من إدارة الصحيفة

## 🚨 في حالة الخطأ

إذا واجهت أي خطأ:
1. تحقق من اتصال قاعدة البيانات
2. تأكد من صلاحيات المستخدم
3. راجع سجل الأخطاء المعروض 