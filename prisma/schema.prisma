generator client {
  provider        = "prisma-client-js"
  binaryTargets   = ["native", "rhel-openssl-1.0.x", "rhel-openssl-3.0.x"]
  previewFeatures = ["relationJoins"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model EmailJob {
  id            String          @id
  template_id   String?
  scheduled_at  DateTime?
  started_at    DateTime?
  completed_at  DateTime?
  status        EmailJob_status @default(queued)
  target_filter Json?
  metadata      Json?
  stats         Json?
  created_at    DateTime        @default(now())
  updated_at    DateTime

  @@index([status, scheduled_at])
}

model EmailLog {
  id              String          @id
  job_id          String?
  subscriber_id   String
  provider_msg_id String?
  message_id      String?
  status          EmailLog_status @default(pending)
  error           String?
  opened_at       DateTime?
  clicked_at      DateTime?
  unsubscribed_at DateTime?
  meta            Json?
  event_at        DateTime        @default(now())

  @@index([status])
  @@index([subscriber_id])
}

model EmailProviderConfig {
  id              String                   @id
  type            EmailProviderConfig_type @default(smtp)
  sender_name     String
  sender_email    String
  api_key         String?
  host            String?
  port            Int?
  username        String?
  password        String?
  footer_html     String?
  unsubscribe_url String?
  created_at      DateTime                 @default(now())
  updated_at      DateTime
}

model EmailTemplate {
  id           String   @id
  name         String   @db.VarChar(255)
  subject      String   @db.VarChar(500)
  html_content String
  text_content String?
  metadata     Json?
  created_at   DateTime @default(now())
  updated_at   DateTime
}

model Subscriber {
  id          String            @id
  email       String            @unique
  name        String?           @db.VarChar(255)
  status      Subscriber_status @default(active)
  preferences Json?
  metadata    Json?
  created_at  DateTime          @default(now())
  updated_at  DateTime
}

model activity_logs {
  id          String   @id
  user_id     String?
  action      String
  entity_type String?
  entity_id   String?
  old_value   Json?
  new_value   Json?
  metadata    Json?
  ip_address  String?  @db.VarChar(45)
  user_agent  String?
  created_at  DateTime @default(now())
}

model analytics_data {
  id           String   @id
  date         DateTime @db.Date
  metric_name  String   @db.VarChar(100)
  metric_value Decimal  @db.Decimal(15, 2)
  dimensions   Json?
  metadata     Json?
  created_at   DateTime @default(now())

  @@unique([date, metric_name])
  @@index([date])
  @@index([metric_name])
}

model article_keywords {
  id         String   @id
  article_id String
  keyword_id String
  created_at DateTime @default(now())

  @@unique([article_id, keyword_id])
  @@index([article_id])
  @@index([keyword_id])
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model articles {
  id                String              @id
  title             String              @db.VarChar(500)
  slug              String              @db.VarChar(500)
  content           String
  excerpt           String?
  author_id         String
  category_id       String?
  status            String              @default("draft")
  featured          Boolean             @default(false)
  breaking          Boolean             @default(false)
  featured_image    String?
  published_at      DateTime?
  scheduled_for     DateTime?
  views             Int                 @default(0)
  reading_time      Int?
  seo_title         String?
  seo_description   String?
  seo_keywords      String?
  social_image      String?
  allow_comments    Boolean             @default(true)
  metadata          Json?
  created_at        DateTime            @default(now())
  updated_at        DateTime
  audio_summary_url String?
  likes             Int                 @default(0)
  saves             Int                 @default(0)
  shares            Int                 @default(0)

  // New fields for enhanced article system
  article_author_id String?
  summary           String?             // Ù…Ù„Ø®Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠ
  ai_quotes         String[]            // Ø§Ù‚ØªØ¨Ø§Ø³Ø§Øª Ø°ÙƒÙŠØ©
  tags              String[]            // ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ©
  article_type      String              @default("opinion") // Ù†ÙˆØ¹ Ø§Ù„Ù…Ù‚Ø§Ù„
  is_opinion_leader Boolean             @default(false) // Ù‚Ø§Ø¦Ø¯ Ø§Ù„Ø±Ø£ÙŠ Ø§Ù„ÙŠÙˆÙ…

  // Existing relationships
  categories        categories?         @relation(fields: [category_id], references: [id])
  interactions      interactions[]

  // Author relationship (existing)
  author            users?              @relation("ArticleAuthor", fields: [author_id], references: [id])

  // New article author relationship
  article_author    article_authors?    @relation(fields: [article_author_id], references: [id])

  // AI system relationships
  ml_predictions    MLPredictions[]
  sentiment_analyses SentimentAnalysis[]
  article_quotes    article_quotes[]

  @@index([article_author_id])
  @@index([article_type])
  @@index([tags])
}

model audio_episodes {
  id                String         @id
  program_id        String
  episode_number    Int?
  title             String
  content           String
  audio_url         String?
  duration          Int?
  voice_model       String         @default("bradford")
  scheduled_at      DateTime?
  published_at      DateTime?
  status            String         @default("draft")
  generation_status String         @default("pending")
  views             Int            @default(0)
  metadata          Json?
  created_at        DateTime       @default(now())
  updated_at        DateTime
  created_by        String?
  users             users?         @relation(fields: [created_by], references: [id])
  audio_programs    audio_programs @relation(fields: [program_id], references: [id], onDelete: Cascade)

  @@index([program_id])
  @@index([scheduled_at])
  @@index([status])
}

model audio_newsletters {
  id           String   @id
  title        String
  content      String
  audioUrl     String
  duration     Int
  voice_id     String
  voice_name   String
  language     String   @default("ar")
  category     String?
  is_published Boolean  @default(false)
  is_featured  Boolean  @default(false)
  is_main_page Boolean  @default(false) // Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„ Ø¬Ø¯ÙŠØ¯ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  play_count   Int      @default(0)
  created_at   DateTime @default(now()) @db.Timestamp(6)
  updated_at   DateTime @default(now()) @db.Timestamp(6)

  @@index([created_at])
  @@index([is_featured])
  @@index([is_published])
  @@index([is_main_page]) // Ø¥Ø¶Ø§ÙØ© index Ù„Ù„Ø­Ù‚Ù„ Ø§Ù„Ø¬Ø¯ÙŠØ¯
}

model audio_programs {
  id                 String           @id
  name               String
  description        String?
  short_description  String?
  logo_url           String?
  thumbnail_url      String?
  preferred_duration Int?
  voice_model        String           @default("bradford")
  display_position   String           @default("header")
  display_order      Int              @default(0)
  status             String           @default("active")
  slug               String           @unique
  settings           Json?
  created_at         DateTime         @default(now())
  updated_at         DateTime
  created_by         String?
  audio_episodes     audio_episodes[]
  users              users?           @relation(fields: [created_by], references: [id])

  @@index([slug])
  @@index([status])
}

model audio_scheduled_jobs {
  id              String    @id
  episode_id      String
  job_type        String
  scheduled_for   DateTime
  status          String    @default("pending")
  attempts        Int       @default(0)
  last_attempt_at DateTime?
  error_message   String?
  completed_at    DateTime?
  created_at      DateTime  @default(now())

  @@index([episode_id])
  @@index([scheduled_for])
  @@index([status])
}

model categories {
  id            String     @id
  name          String
  slug          String     @unique
  description   String?
  display_order Int        @default(0)
  is_active     Boolean    @default(true)
  color         String?    @db.VarChar(50)
  icon          String?    @db.VarChar(50)
  metadata      Json?
  name_en       String?
  parent_id     String?
  created_at    DateTime   @default(now())
  updated_at    DateTime
  articles      articles[]
  muqtarab_corners MuqtarabCorner[]
  user_interests   user_interests[]
}

model comments {
  id         String   @id
  article_id String
  user_id    String?
  parent_id  String?
  content    String
  status     String   @default("pending")
  likes      Int      @default(0)
  metadata   Json?
  created_at DateTime @default(now())
  updated_at DateTime
}

model daily_doses {
  id               String             @id
  period           daily_doses_period
  title            String             @db.VarChar(500)  // Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
  subtitle         String             @db.VarChar(500)  // Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙØ±Ø¹ÙŠ
  date             DateTime           @db.Date
  status           daily_doses_status @default(draft)
  publishedAt      DateTime?
  views            Int                @default(0)
  metadata         Json?

  // Ø¥Ø¶Ø§ÙØ§Øª Ø§Ù„Ø¬Ø±Ø¹Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©
  topics           String[]           @default([])      // Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø§Ù„Ø¬Ø±Ø¹Ø©
  source_articles  String[]           @default([])      // Ù…Ø¹Ø±ÙØ§Øª Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
  generated_by_ai  Boolean            @default(false)   // Ù…ÙˆÙ„Ø¯Ø© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
  ai_prompt_used   String?                              // Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  user_id          String?                              // Ù„Ù„Ø¬Ø±Ø¹Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ©
  is_global        Boolean            @default(true)    // Ø¬Ø±Ø¹Ø© Ø¹Ø§Ù…Ø©
  interaction_count Int               @default(0)       // Ø¹Ø¯Ø¯ Ø§Ù„ØªÙØ§Ø¹Ù„Ø§Øª
  share_count      Int                @default(0)       // Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ§Øª
  created_by       String?                              // Ø§Ù„Ù…Ø­Ø±Ø±
  editor_notes     String?                              // Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø­Ø±Ø±

  createdAt        DateTime           @default(now())
  updatedAt        DateTime

  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  feedback         smart_dose_feedback[]
  user             users?             @relation("UserDoses", fields: [user_id], references: [id], onDelete: Cascade)
  creator          users?             @relation("DoseCreator", fields: [created_by], references: [id])

  @@unique([date, period])
  @@unique([date, period, user_id]) // Ø¬Ø±Ø¹Ø© ÙˆØ§Ø­Ø¯Ø© Ù„ÙƒÙ„ ÙØªØ±Ø© ÙŠÙˆÙ…ÙŠØ§Ù‹ Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù…
  @@index([date])
  @@index([period])
  @@index([status])
  @@index([user_id, period])
  @@index([is_global, period])
}

model deep_analyses {
  id                  String   @id
  article_id          String
  ai_summary          String?
  key_topics          Json?
  tags                Json?
  sentiment           String?
  readability_score   Decimal? @db.Decimal(5, 2)
  engagement_score    Int?
  suggested_headlines Json?
  related_articles    Json?
  metadata            Json?
  analyzed_at         DateTime @default(now())
  updated_at          DateTime
}

model dose_contents {
  id           String                    @id
  doseId       String
  articleId    String?
  contentType  dose_contents_contentType
  title        String                    @db.VarChar(500)
  summary      String
  audioUrl     String?
  imageUrl     String?
  displayOrder Int                       @default(0)
  metadata     Json?
  createdAt    DateTime                  @default(now())

  @@index([articleId])
  @@index([doseId])
}

model email_verification_codes {
  id         String    @id
  email      String    @db.VarChar(255)
  code       String    @db.VarChar(6)
  user_id    String?
  expires_at DateTime
  used_at    DateTime?
  created_at DateTime  @default(now())

  @@index([code])
  @@index([email])
  @@index([expires_at])
}

model forum_badges {
  id           String    @id
  name         String    @db.VarChar(255)
  name_ar      String    @db.VarChar(255)
  description  String?
  icon         String?   @db.VarChar(50)
  color        String?   @db.VarChar(50)
  requirements Json?
  points       Int?      @default(0)
  is_active    Boolean?  @default(true)
  created_at   DateTime? @default(now())
  updated_at   DateTime? @default(now())
}

model forum_categories {
  id            String    @id
  name          String    @db.VarChar(255)
  name_ar       String    @db.VarChar(255)
  slug          String    @unique(map: "slug") @db.VarChar(255)
  description   String?
  icon          String?   @db.VarChar(50)
  color         String?   @db.VarChar(50)
  display_order Int?      @default(0)
  is_active     Boolean?  @default(true)
  created_at    DateTime? @default(now())
  updated_at    DateTime? @default(now())

  @@index([display_order])
  @@index([slug])
}

model forum_follows {
  id          String                    @id
  user_id     String
  target_type forum_follows_target_type
  target_id   String
  created_at  DateTime?                 @default(now())

  @@unique([user_id, target_type, target_id])
  @@index([target_type, target_id])
  @@index([user_id])
}

model forum_notifications {
  id          String    @id
  user_id     String
  type        String    @db.VarChar(50)
  target_type String?   @db.VarChar(50)
  target_id   String?
  data        Json?
  is_read     Boolean?  @default(false)
  created_at  DateTime? @default(now())

  @@index([created_at])
  @@index([user_id, is_read])
}

model forum_replies {
  id          String                @id
  topic_id    String
  parent_id   String?
  author_id   String
  content     String
  is_accepted Boolean?              @default(false)
  status      forum_replies_status? @default(active)
  edited_at   DateTime?
  edited_by   String?
  created_at  DateTime?             @default(now())
  updated_at  DateTime?             @default(now())

  @@index([author_id])
  @@index([created_at])
  @@index([parent_id])
  @@index([topic_id])
}

model forum_reports {
  id          String                    @id
  reporter_id String
  target_type forum_reports_target_type
  target_id   String
  reason      String                    @db.VarChar(255)
  description String?
  status      forum_reports_status?     @default(pending)
  resolved_by String?
  resolved_at DateTime?
  created_at  DateTime?                 @default(now())

  @@index([reporter_id])
  @@index([status])
  @@index([target_type, target_id])
}

model forum_reputation {
  id          String    @id
  user_id     String
  points      Int?      @default(0)
  action_type String    @db.VarChar(50)
  target_type String?   @db.VarChar(50)
  target_id   String?
  description String?
  created_at  DateTime? @default(now())

  @@index([created_at])
  @@index([user_id])
}

model forum_topics {
  id            String               @id
  title         String               @db.VarChar(500)
  content       String
  author_id     String
  category_id   String
  is_pinned     Boolean?             @default(false)
  is_locked     Boolean?             @default(false)
  is_featured   Boolean?             @default(false)
  status        forum_topics_status? @default(active)
  views         Int?                 @default(0)
  last_reply_at DateTime?
  last_reply_by String?
  created_at    DateTime?            @default(now())
  updated_at    DateTime?            @default(now())

  @@index([author_id])
  @@index([category_id])
  @@index([last_reply_at])
  @@index([status, created_at])
}

model forum_user_badges {
  id        String    @id
  user_id   String
  badge_id  String
  earned_at DateTime? @default(now())

  @@unique([user_id, badge_id])
  @@index([badge_id])
  @@index([user_id])
}

model forum_votes {
  id          String                  @id
  user_id     String
  target_type forum_votes_target_type
  target_id   String
  vote_type   forum_votes_vote_type
  created_at  DateTime?               @default(now())

  @@unique([user_id, target_type, target_id])
  @@index([target_type, target_id])
  @@index([user_id])
}

model home_blocks_config {
  id            String   @id
  block_type    String   @db.VarChar(50)
  title         String   @db.VarChar(255)
  subtitle      String?  @db.VarChar(255)
  settings      Json
  display_order Int      @default(0)
  is_active     Boolean  @default(true)
  created_at    DateTime @default(now())
  updated_at    DateTime
}

model interactions {
  id         String            @id
  user_id    String
  article_id String
  type       interactions_type
  created_at DateTime          @default(now())
  articles   articles          @relation(fields: [article_id], references: [id])
  users      users             @relation(fields: [user_id], references: [id])

  @@unique([user_id, article_id, type])
  @@index([article_id, type, created_at(sort: Desc)], map: "idx_interactions_article_type")
  @@index([article_id])
  @@index([user_id])
}

model keywords {
  id         String   @id
  name       String
  slug       String
  count      Int      @default(0)
  created_at DateTime @default(now())
}

model loyalty_points {
  id             String   @id
  user_id        String
  points         Int
  action         String   @db.VarChar(100)
  reference_id   String?
  reference_type String?
  metadata       Json?
  created_at     DateTime @default(now())
}

model messages {
  id            String    @id
  from_user_id  String?
  to_user_id    String?
  email         String
  subject       String?   @db.VarChar(500)
  message       String
  status        String    @default("unread")
  replied_at    DateTime?
  reply_content String?
  metadata      Json?
  created_at    DateTime  @default(now())
}

model opinion_articles {
  id              String                @id
  title           String
  content         String
  excerpt         String?
  authorId        String
  category        String
  status          OpinionArticle_status @default(draft)
  isActive        Boolean               @default(true)
  views           Int                   @default(0)
  likes           Int                   @default(0)
  shares          Int                   @default(0)
  saves           Int                   @default(0)
  readingTime     Int?
  featuredImage   String?
  audioUrl        String?
  seoKeywords     String[]
  publishedAt     DateTime?
  metadata        Json?
  createdAt       DateTime              @default(now())
  updatedAt       DateTime
  opinion_authors opinion_authors       @relation(fields: [authorId], references: [id], onDelete: Cascade)

  @@index([authorId])
  @@index([category])
  @@index([publishedAt])
  @@index([status, isActive])
}

model opinion_authors {
  id               String             @id
  name             String
  email            String?            @unique
  title            String?
  avatarUrl        String?
  bio              String?
  category         String?
  twitterUrl       String?
  linkedinUrl      String?
  websiteUrl       String?
  isActive         Boolean            @default(true)
  displayOrder     Int?
  metadata         Json?
  createdAt        DateTime           @default(now())
  updatedAt        DateTime
  opinion_articles opinion_articles[]
}

model password_reset_tokens {
  id         String    @id
  user_id    String
  token      String    @unique @db.VarChar(255)
  expires_at DateTime
  used_at    DateTime?
  created_at DateTime  @default(now())

  @@index([expires_at])
  @@index([token])
  @@index([user_id])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model roles {
  id           String   @id
  name         String   @unique @db.VarChar(100)
  slug         String?
  display_name String?
  description  String?
  permissions  Json?
  is_system    Boolean  @default(false)
  created_at   DateTime @default(now())
  updated_at   DateTime
}

model site_settings {
  id         String   @id
  section    String   @db.VarChar(50)
  data       Json
  created_at DateTime @default(now())
  updated_at DateTime
}

model smart_blocks {
  id            String    @id
  name          String    @db.VarChar(255)
  type          String    @db.VarChar(50)
  config        Json
  ai_config     Json?
  display_rules Json?
  is_active     Boolean   @default(true)
  last_updated  DateTime?
  performance   Json?
  created_at    DateTime  @default(now())
  updated_at    DateTime
}

model team_members {
  id            String   @id
  name          String   @db.VarChar(255)
  role          String   @db.VarChar(100)
  department    String?  @db.VarChar(100)
  bio           String?
  avatar        String?
  email         String?  @db.VarChar(255)
  phone         String?  @db.VarChar(50)
  social_links  Json?
  is_active     Boolean  @default(true)
  display_order Int      @default(0)
  created_at    DateTime @default(now())
  updated_at    DateTime
}

model template_previews {
  id          String   @id
  template_id String
  title       String   @db.VarChar(500)
  content     String
  metadata    Json?
  created_at  DateTime @default(now())

  @@index([template_id])
}

model templates {
  id           String   @id
  name         String   @db.VarChar(255)
  slug         String   @db.VarChar(255)
  description  String?
  category     String   @db.VarChar(50)
  content      Json
  variables    Json?
  preview_data Json?
  is_active    Boolean  @default(true)
  usage_count  Int      @default(0)
  created_by   String?
  created_at   DateTime @default(now())
  updated_at   DateTime
}

model timeline_events {
  id             String   @id
  event_type     String   @db.VarChar(50)
  entity_type    String   @db.VarChar(50)
  entity_id      String?
  title          String   @db.VarChar(500)
  description    String?
  icon           String?  @db.VarChar(50)
  url            String?  @db.VarChar(500)
  user_id        String?
  author_name    String?  @db.VarChar(255)
  author_avatar  String?
  category_name  String?  @db.VarChar(255)
  category_color String?  @db.VarChar(50)
  metadata       Json?
  is_important   Boolean  @default(false)
  created_at     DateTime @default(now())
}

model user_insights {
  id                      String    @id @db.VarChar(36)
  user_id                 String    @unique @db.VarChar(36)
  total_reads             Int?      @default(0)
  total_saved             Int?      @default(0)
  total_interactions      Int?      @default(0)
  avg_read_time           Float?
  preferred_reading_time  String?   @db.VarChar(50)
  reader_type             String?   @db.VarChar(50)
  diversity_score         Float?
  preferred_categories    Json?
  preferred_article_types Json?
  avg_article_length      Int?
  weekly_reads            Int?      @default(0)
  weekly_streak           Int?      @default(0)
  last_read_date          DateTime? @db.Timestamptz(6)
  calculated_at           DateTime? @default(now()) @db.Timestamptz(6)
  updated_at              DateTime? @default(now()) @db.Timestamptz(6)
}

model user_preferences {
  id         String   @id
  user_id    String
  key        String
  value      Json
  created_at DateTime @default(now())
  updated_at DateTime

  @@unique([user_id, key])
  @@index([user_id])
}

model user_reading_sessions {
  id               String    @id @db.VarChar(36)
  user_id          String    @db.VarChar(36)
  article_id       String    @db.VarChar(36)
  started_at       DateTime? @default(now()) @db.Timestamptz(6)
  ended_at         DateTime? @db.Timestamptz(6)
  duration_seconds Int?
  read_percentage  Float?
  scroll_depth     Float?
  device_type      String?   @db.VarChar(50)
  time_of_day      Int?
  created_at       DateTime? @default(now()) @db.Timestamptz(6)
}

model user_roles {
  id         String    @id
  user_id    String
  role_id    String
  granted_by String?
  granted_at DateTime  @default(now())
  expires_at DateTime?
}

model user_similar_readers {
  id                String    @id @db.VarChar(36)
  user_id           String    @db.VarChar(36)
  similar_user_id   String    @db.VarChar(36)
  similarity_score  Float?
  common_categories Json?
  calculated_at     DateTime? @default(now()) @db.Timestamptz(6)

  @@unique([user_id, similar_user_id])
}

model users {
  id                   String                 @id
  email                String                 @unique
  password_hash        String?
  name                 String?
  avatar               String?
  role                 String                 @default("user")
  is_admin             Boolean                @default(false)
  is_verified          Boolean                @default(false)
  verification_token   String?
  reset_token          String?
  reset_token_expiry   DateTime?
  created_at           DateTime               @default(now())
  updated_at           DateTime

  // Existing relationships
  audio_episodes       audio_episodes[]
  audio_programs       audio_programs[]
  interactions         interactions[]

  // Articles authored by this user
  authored_articles    articles[]             @relation("ArticleAuthor")

  // Reporter profile relationship
  reporter_profile     reporters?

  // New AI system relationships
  user_settings        UserSettings[]
  ml_predictions       MLPredictions[]
  sentiment_analyses   SentimentAnalysis[]
  smart_notifications  SmartNotifications[]
  user_recommendations UserRecommendations[]
  search_queries       SearchQueries[]

  // Muqtarab relationships
  muqtarab_corners     MuqtarabCorner[]
  muqtarab_articles    MuqtarabArticle[]
  muqtarab_interactions MuqtarabInteraction[]
  muqtarab_analytics   MuqtarabAnalytics[]
  muqtarab_followers   MuqtarabFollower[]
  muqtarab_comments    MuqtarabComment[]

  // Smart Doses relationships
  user_doses           daily_doses[]          @relation("UserDoses")
  created_doses        daily_doses[]          @relation("DoseCreator")
  dose_feedback        smart_dose_feedback[]  @relation("DoseFeedbackUser")
  dose_templates       smart_dose_templates[] @relation("DoseTemplateCreator")

  // User interests relationship
  interests            user_interests[]

  @@index([email], map: "idx_users_email")
  @@index([role], map: "idx_users_role")
  @@index([email])
  @@index([role])
}

// ==============================================================
// Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ù„Ù…Ø±Ø§Ø³Ù„ Ø§Ù„Ø°ÙƒÙŠ
// ==============================================================

model reporters {
  id                    String   @id @default(cuid())
  user_id               String   @unique

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‡ÙˆÙŠØ©
  full_name             String
  slug                  String   @unique  // Ù„Ù„Ù€ URL
  title                 String?            // Ù…Ø«Ù„ "Ù…Ø±Ø§Ø³Ù„ Ù…ÙŠØ¯Ø§Ù†ÙŠ", "Ù…Ø­Ø±Ø± Ø§Ù‚ØªØµØ§Ø¯ÙŠ"
  bio                   String?           // Ø§Ù„Ù†Ø¨Ø°Ø© Ø§Ù„Ù…Ù‡Ù†ÙŠØ©
  avatar_url            String?

  // Ø§Ù„ØªØ­Ù‚Ù‚ ÙˆØ§Ù„Ù…ÙƒØ§Ù†Ø©
  is_verified           Boolean  @default(false)
  verification_badge    String?  @default("verified") // "verified", "expert", "senior"

  // Ø§Ù„ØªØ®ØµØµØ§Øª ÙˆØ§Ù„ØªØºØ·ÙŠØ©
  specializations       Json?    // ["Ø§Ù‚ØªØµØ§Ø¯", "Ø³ÙŠØ§Ø³Ø©", "Ø±ÙŠØ§Ø¶Ø©"]
  coverage_areas        Json?    // ["Ø§Ù„Ø±ÙŠØ§Ø¶", "Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø´Ø±Ù‚ÙŠØ©", "Ø¯ÙˆÙ„ÙŠ"]
  languages             Json?    @default("[\"ar\"]") // ["ar", "en"]

  // Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙˆØ§ØµÙ„
  twitter_url           String?
  linkedin_url          String?
  website_url           String?
  email_public          String?  // Ø¨Ø±ÙŠØ¯ Ø¹Ø§Ù… Ù„Ù„ØªÙˆØ§ØµÙ„

  // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡
  total_articles        Int      @default(0)
  total_views           Int      @default(0)
  total_likes           Int      @default(0)
  total_shares          Int      @default(0)
  avg_reading_time      Float?
  engagement_rate       Float    @default(0.0)

  // ØªØ­Ù„ÙŠÙ„ Ø°ÙƒÙŠ
  writing_style         Json?    // ØªØ­Ù„ÙŠÙ„ Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„ÙƒØªØ§Ø¨Ø©
  popular_topics        Json?    // Ø£ÙƒØ«Ø± Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ ÙƒØªØ§Ø¨Ø©
  publication_pattern   Json?    // Ù†Ù…Ø· Ø§Ù„Ù†Ø´Ø± (Ø£ÙˆÙ‚Ø§ØªØŒ Ø£ÙŠØ§Ù…)
  reader_demographics   Json?    // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø±Ø¶
  is_active             Boolean  @default(true)
  show_stats            Boolean  @default(true)
  show_contact          Boolean  @default(false)
  display_order         Int?

  // Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
  created_at            DateTime @default(now())
  updated_at            DateTime @updatedAt

  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  user                  users    @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@map("reporters")
  @@index([slug])
  @@index([is_active])
  @@index([is_verified])
  @@index([total_articles])
}

model was_news {
  id               String   @id
  news_NUM         Int      @unique
  news_DT          DateTime
  news_basket_CD   Int
  news_class_CD    Int
  news_priority_CD Int
  is_Report        Boolean  @default(false)
  title_TXT        String
  story_TXT        String?
  media            Json?
  royalType        Int?
  keywords         Json?
  related_news_CD  Int?
  is_imported      Boolean  @default(false)
  imported_to_id   String?
  created_at       DateTime @default(now())
  updated_at       DateTime @default(now())

  @@index([created_at])
  @@index([is_imported])
  @@index([news_DT])
  @@index([news_basket_CD])
}

enum EmailJob_status {
  queued
  sending
  completed
  cancelled
  failed
}

enum EmailLog_status {
  pending
  sent
  delivered
  bounced
  opened
  clicked
  unsubscribed
  failed
}

enum EmailProviderConfig_type {
  smtp
  sendgrid
  mailgun
  ses
}

enum OpinionArticle_status {
  draft
  published
  archived
}

enum Subscriber_status {
  active
  inactive
  unsubscribed
}

enum daily_doses_period {
  morning
  afternoon
  evening
  night
}

enum daily_doses_status {
  draft
  published
  scheduled
  archived
}

enum dose_contents_contentType {
  article
  weather
  quote
  tip
  audio
  analysis
}

enum forum_follows_target_type {
  topic
  user
  category
}

enum forum_replies_status {
  active
  pending
  hidden
  deleted
}

enum forum_reports_status {
  pending
  resolved
  dismissed
}

enum forum_reports_target_type {
  topic
  reply
}

enum forum_topics_status {
  active
  pending
  hidden
  deleted
}

enum forum_votes_target_type {
  topic
  reply
}

enum forum_votes_vote_type {
  like
  dislike
}

enum interactions_type {
  like
  save
  share
  comment
  view
  reading_session
}

// ==============================================
// ğŸ§  Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© - Ø³Ø¨Ù‚ Ø§Ù„Ø°ÙƒÙŠØ©
// ==============================================

// âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
model SystemSettings {
  id                String   @id @default(cuid())
  module            String   // 'general', 'typography', 'theme', 'ai'
  category          String   // ÙØ¦Ø© ÙØ±Ø¹ÙŠØ© Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯
  key               String   // Ù…ÙØªØ§Ø­ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
  value             Json     // Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ (Ù…Ø±Ù†Ø©)
  data_type         String   // Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: string, number, boolean, json
  description       String?  // ÙˆØµÙ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
  is_public         Boolean  @default(false) // Ù‡Ù„ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø±Ø¤ÙŠØªÙ‡
  is_user_editable  Boolean  @default(false) // Ù‡Ù„ ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ØªØ¹Ø¯ÙŠÙ„Ù‡
  default_value     Json?    // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
  validation_rules  Json?    // Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„ØªØ­Ù‚Ù‚
  created_at        DateTime @default(now())
  updated_at        DateTime @updatedAt

  @@unique([module, category, key])
  @@index([module, category])
}

// ğŸ¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø´Ø®ØµÙŠØ©
model UserSettings {
  id                String   @id @default(cuid())
  user_id           String
  module            String
  key               String
  value             Json
  created_at        DateTime @default(now())
  updated_at        DateTime @updatedAt

  users             users    @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([user_id, module, key])
  @@index([user_id, module])
}

// ğŸ§ª Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø¢Ù„ÙŠ
model MLModels {
  id                String           @id @default(cuid())
  name              String           @unique
  type              MLModelType      // Ù†ÙˆØ¹ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
  version           String
  description       String?
  status            MLModelStatus    @default(training)
  config            Json             // ØªÙƒÙˆÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
  hyperparameters   Json?            // Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„ÙØ§Ø¦Ù‚Ø©
  training_data     Json?            // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨
  performance_metrics Json?          // Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„Ø£Ø¯Ø§Ø¡
  model_path        String?          // Ù…Ø³Ø§Ø± Ù…Ù„Ù Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
  api_endpoint      String?          // Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© API
  is_active         Boolean          @default(false)
  created_at        DateTime         @default(now())
  updated_at        DateTime         @updatedAt

  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  training_jobs     MLTrainingJobs[]
  predictions       MLPredictions[]
}

model MLTrainingJobs {
  id                String            @id @default(cuid())
  model_id          String
  status            TrainingStatus    @default(queued)
  dataset_config    Json              // ØªÙƒÙˆÙŠÙ† Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  training_config   Json              // ØªÙƒÙˆÙŠÙ† Ø§Ù„ØªØ¯Ø±ÙŠØ¨
  progress          Float             @default(0)
  metrics           Json?             // Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„ØªØ¯Ø±ÙŠØ¨
  error_log         String?
  started_at        DateTime?
  completed_at      DateTime?
  created_at        DateTime          @default(now())

  model             MLModels          @relation(fields: [model_id], references: [id], onDelete: Cascade)

  @@index([model_id, status])
}

model MLPredictions {
  id                String           @id @default(cuid())
  model_id          String
  input_data        Json             // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø©
  prediction        Json             // Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©
  confidence_score  Float?           // Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø©
  processing_time   Int?             // ÙˆÙ‚Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨Ø§Ù„Ù…ÙŠÙ„ÙŠ Ø«Ø§Ù†ÙŠØ©
  user_id           String?          // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø±ØªØ¨Ø·
  article_id        String?          // Ø§Ù„Ù…Ù‚Ø§Ù„ Ø§Ù„Ù…Ø±ØªØ¨Ø·
  created_at        DateTime         @default(now())

  model             MLModels         @relation(fields: [model_id], references: [id], onDelete: Cascade)
  user              users?           @relation(fields: [user_id], references: [id], onDelete: SetNull)
  article           articles?        @relation(fields: [article_id], references: [id], onDelete: SetNull)

  @@index([model_id, created_at])
  @@index([user_id, created_at])
}

// ğŸ’­ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
model SentimentAnalysis {
  id                String           @id @default(cuid())
  content_id        String           // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø­ØªÙˆÙ‰ (Ù…Ù‚Ø§Ù„ØŒ ØªØ¹Ù„ÙŠÙ‚ØŒ Ø¥Ù„Ø®)
  content_type      String           // Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
  text_content      String           // Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø­Ù„Ù„
  sentiment_score   Float            // Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…Ø´Ø§Ø¹Ø± (-1 Ø¥Ù„Ù‰ 1)
  sentiment_label   SentimentLabel   // ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
  confidence        Float            // Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø©
  emotions          Json?            // Ø§Ù„Ù…Ø´Ø§Ø¹Ø± Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©
  keywords          String[]         // Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ø§Ù„Ù…Ø¤Ø«Ø±Ø©
  language          String           @default("ar")
  model_version     String           // Ø¥ØµØ¯Ø§Ø± Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„
  processed_at      DateTime         @default(now())

  // User relationships (optional)
  user_id           String?
  user              users?           @relation(fields: [user_id], references: [id], onDelete: SetNull)

  // Article relationships (optional)
  article_id        String?
  article           articles?        @relation(fields: [article_id], references: [id], onDelete: SetNull)

  @@index([content_type, sentiment_label])
  @@index([processed_at])
  @@index([user_id])
  @@index([article_id])
}

// ğŸ”” Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
model SmartNotifications {
  id                String              @id @default(cuid())
  user_id           String?
  title             String
  message           String
  type              NotificationType
  priority          NotificationPriority @default(medium)
  category          String?             // ÙØ¦Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
  data              Json?               // Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
  scheduled_at      DateTime?           // ÙˆÙ‚Øª Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø¬Ø¯ÙˆÙ„
  sent_at           DateTime?
  read_at           DateTime?
  clicked_at        DateTime?
  status            NotificationStatus  @default(pending)
  delivery_channels String[]            // Ù‚Ù†ÙˆØ§Øª Ø§Ù„ØªÙˆØµÙŠÙ„
  ai_optimized      Boolean            @default(false) // Ù…Ø­Ø³Ù† Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
  personalization_score Float?          // Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ®ØµÙŠØµ
  created_at        DateTime           @default(now())

  user              users?             @relation(fields: [user_id], references: [id], onDelete: SetNull)

  @@index([user_id, status])
  @@index([scheduled_at, status])
  @@index([type, priority])
}

// âš¡ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡
model PerformanceMetrics {
  id                String           @id @default(cuid())
  metric_type       String           // Ù†ÙˆØ¹ Ø§Ù„Ù…Ù‚ÙŠØ§Ø³
  metric_name       String           // Ø§Ø³Ù… Ø§Ù„Ù…Ù‚ÙŠØ§Ø³
  value             Float            // Ø§Ù„Ù‚ÙŠÙ…Ø©
  unit              String?          // Ø§Ù„ÙˆØ­Ø¯Ø©
  context           Json?            // Ø³ÙŠØ§Ù‚ Ø¥Ø¶Ø§ÙÙŠ
  timestamp         DateTime         @default(now())
  tags              String[]         // Ø¹Ù„Ø§Ù…Ø§Øª Ù„Ù„ØªØµÙÙŠØ©

  @@index([metric_type, timestamp])
  @@index([metric_name, timestamp])
}

// ğŸ¯ Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙˆØµÙŠØ§Øª
model RecommendationModels {
  id                String           @id @default(cuid())
  name              String           @unique
  type              RecommendationType
  algorithm         String           // Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„ØªÙˆØµÙŠØ©
  config            Json             // ØªÙƒÙˆÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
  is_active         Boolean          @default(false)
  performance_score Float?           // Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡
  created_at        DateTime         @default(now())
  updated_at        DateTime         @updatedAt

  recommendations   UserRecommendations[]
}

model UserRecommendations {
  id                String              @id @default(cuid())
  user_id           String
  model_id          String
  recommended_items Json                // Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§
  confidence_scores Json                // Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø«Ù‚Ø©
  reason            String?             // Ø³Ø¨Ø¨ Ø§Ù„ØªÙˆØµÙŠØ©
  clicked_items     String[]            // Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªÙŠ ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„ÙŠÙ‡Ø§
  feedback_score    Float?              // ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  created_at        DateTime            @default(now())
  expires_at        DateTime?           // Ø§Ù†ØªÙ‡Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ØªÙˆØµÙŠØ©

  user              users               @relation(fields: [user_id], references: [id], onDelete: Cascade)
  model             RecommendationModels @relation(fields: [model_id], references: [id], onDelete: Cascade)

  @@index([user_id, created_at])
  @@index([model_id, created_at])
}

// ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ
model SearchQueries {
  id                String           @id @default(cuid())
  user_id           String?
  query             String
  query_vector      Json?            // ØªÙ…Ø«ÙŠÙ„ vectorial Ù„Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…
  filters           Json?            // ÙÙ„Ø§ØªØ± Ø§Ù„Ø¨Ø­Ø«
  results_count     Int              @default(0)
  clicked_results   String[]         // Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙŠ ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„ÙŠÙ‡Ø§
  search_time_ms    Int?             // ÙˆÙ‚Øª Ø§Ù„Ø¨Ø­Ø«
  result_quality    Float?           // Ø¬ÙˆØ¯Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
  session_id        String?          // Ù…Ø¹Ø±Ù Ø§Ù„Ø¬Ù„Ø³Ø©
  ip_address        String?
  user_agent        String?
  created_at        DateTime         @default(now())

  user              users?           @relation(fields: [user_id], references: [id], onDelete: SetNull)

  @@index([user_id, created_at])
  @@index([query, created_at])
}

// ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
model AdvancedAnalytics {
  id                String           @id @default(cuid())
  metric_category   String           // ÙØ¦Ø© Ø§Ù„Ù…Ù‚ÙŠØ§Ø³
  metric_name       String           // Ø§Ø³Ù… Ø§Ù„Ù…Ù‚ÙŠØ§Ø³
  dimensions        Json             // Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ (ØªØµÙ†ÙŠÙØ§ØªØŒ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†ØŒ Ø¥Ù„Ø®)
  measures          Json             // Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª (Ø¹Ø¯Ø¯ØŒ Ù…Ø¬Ù…ÙˆØ¹ØŒ Ù…ØªÙˆØ³Ø·ØŒ Ø¥Ù„Ø®)
  time_period       String           // Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©
  aggregation_level String           // Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ¬Ù…ÙŠØ¹
  filters           Json?            // ÙÙ„Ø§ØªØ± Ù…Ø·Ø¨Ù‚Ø©
  raw_data          Json?            // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù…
  computed_at       DateTime         @default(now())

  @@index([metric_category, time_period])
  @@index([metric_name, computed_at])
}

// ğŸŒ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©
model ExternalDataSources {
  id                String           @id @default(cuid())
  name              String           @unique
  type              String           // RSS, API, WebScraping
  url               String
  config            Json             // ØªÙƒÙˆÙŠÙ† Ø§Ù„Ù…ØµØ¯Ø±
  last_sync         DateTime?
  sync_frequency    String           // ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©
  is_active         Boolean          @default(true)
  error_count       Int              @default(0)
  success_count     Int              @default(0)
  created_at        DateTime         @default(now())
  updated_at        DateTime         @updatedAt

  imported_content  ExternalContent[]
}

model ExternalContent {
  id                String              @id @default(cuid())
  source_id         String
  external_id       String              // Ù…Ø¹Ø±Ù ÙÙŠ Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ
  title             String
  content           String?
  summary           String?
  url               String?
  published_at      DateTime?
  category          String?
  tags              String[]
  metadata          Json?
  import_status     ImportStatus        @default(pending)
  processed_at      DateTime?
  created_at        DateTime            @default(now())

  source            ExternalDataSources @relation(fields: [source_id], references: [id], onDelete: Cascade)

  @@unique([source_id, external_id])
  @@index([source_id, import_status])
}

// ==============================================
// ğŸ”§ Ø§Ù„ØªØ¹Ø¯Ø§Ø¯Ø§Øª (Enums) Ù„Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
// ==============================================

enum MLModelType {
  classification
  regression
  clustering
  recommendation
  nlp
  computer_vision
  time_series
  neural_network
  transformer
}

enum MLModelStatus {
  training
  trained
  deployed
  failed
  deprecated
}

enum TrainingStatus {
  queued
  running
  completed
  failed
  cancelled
}

enum SentimentLabel {
  very_negative
  negative
  neutral
  positive
  very_positive
}

enum NotificationType {
  breaking_news
  article_recommendation
  system_alert
  user_engagement
  performance_warning
  content_moderation
  ai_insight
}

enum NotificationPriority {
  low
  medium
  high
  urgent
}

enum NotificationStatus {
  pending
  scheduled
  sent
  delivered
  read
  failed
}

enum RecommendationType {
  content_based
  collaborative_filtering
  hybrid
  deep_learning
  knowledge_based
}

enum ImportStatus {
  pending
  processing
  completed
  failed
  duplicate
  rejected
}

// ==============================================================
// Ù†Ù…Ø§Ø°Ø¬ Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒÙŠØ§Ù†Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
// ==============================================================

// Ø¬Ø¯ÙˆÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙƒÙŠØ§Ù†Ø§Øª
model SmartEntityTypes {
  id          String @id
  name        String @unique // person, organization, location, etc.
  name_ar     String
  icon        String // Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø£Ùˆ Ø£ÙŠÙ‚ÙˆÙ†Ø©
  color       String // Ù„ÙˆÙ† hex Ù„Ù„ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¨ØµØ±ÙŠ
  description String?
  is_active   Boolean @default(true)

  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt

  // Relations
  entities    SmartEntities[]

  @@map("smart_entity_types")
}

// Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙƒÙŠØ§Ù†Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©
model SmartEntities {
  id               String @id @default(cuid())

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ©
  name             String
  name_ar          String?
  name_en          String?
  entity_type_id   String
  description      String?
  short_bio        String?

  // ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ù‡Ù…ÙŠØ©
  importance_score Int     @default(5) // 1-10
  is_active        Boolean @default(true)
  is_verified      Boolean @default(false)

  // Ø£Ø³Ù…Ø§Ø¡ Ø¨Ø¯ÙŠÙ„Ø© ÙˆÙ…Ø±Ø§Ø¯ÙØ§Øª
  aliases          Json?   // ["Ø§Ø³Ù… Ø¨Ø¯ÙŠÙ„ 1", "Ø§Ø³Ù… Ø¨Ø¯ÙŠÙ„ 2"]

  // Ø±ÙˆØ§Ø¨Ø· ÙˆÙ…Ø¹Ù„ÙˆÙ…Ø§Øª Ø®Ø§Ø±Ø¬ÙŠØ©
  official_website String?
  wikipedia_url    String?
  social_media     Json?   // {twitter: "", linkedin: "", instagram: ""}

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø²Ù…Ù†ÙŠØ©
  birth_date       DateTime?
  start_date       DateTime? // ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹/Ø§Ù„Ù…Ù†ØµØ¨
  end_date         DateTime? // ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ©

  // Ù…ÙˆÙ‚Ø¹ Ø¬ØºØ±Ø§ÙÙŠ
  location         String?
  country          String?  @default("SA")
  region           String?

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª SEO
  slug             String?  @unique
  seo_keywords     String?

  // Ø§Ù„Ø´Ø¹Ø¨ÙŠØ© ÙˆØ§Ù„ØªÙØ§Ø¹Ù„
  mention_count    Int      @default(0) // Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø°ÙƒØ± ÙÙŠ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª
  click_count      Int      @default(0) // Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ù‚Ø±Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
  last_mentioned   DateTime?

  created_at       DateTime @default(now())
  updated_at       DateTime @updatedAt

  // Relations
  entity_type      SmartEntityTypes @relation(fields: [entity_type_id], references: [id])
  entity_links_source EntityLinks[] @relation("SourceEntity")
  entity_links_target EntityLinks[] @relation("TargetEntity")
  smart_links      SmartArticleLinks[]

  @@map("smart_entities")
  @@index([entity_type_id])
  @@index([importance_score])
  @@index([mention_count])
}

// Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¨ÙŠÙ† Ø§Ù„ÙƒÙŠØ§Ù†Ø§Øª (Ø¹Ù„Ø§Ù‚Ø§Øª)
model EntityLinks {
  id                String   @id @default(cuid())
  source_entity_id  String
  target_entity_id  String
  relationship_type String   // works_at, member_of, located_in, part_of, etc.
  relationship_ar   String?  // ÙŠØ¹Ù…Ù„ ÙÙŠØŒ Ø¹Ø¶Ùˆ ÙÙŠØŒ ÙŠÙ‚Ø¹ ÙÙŠØŒ Ø¬Ø²Ø¡ Ù…Ù†
  strength          Int      @default(1) // Ù‚ÙˆØ© Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© 1-10
  is_active         Boolean  @default(true)

  source_entity     SmartEntities @relation("SourceEntity", fields: [source_entity_id], references: [id])
  target_entity     SmartEntities @relation("TargetEntity", fields: [target_entity_id], references: [id])

  created_at        DateTime @default(now())
  updated_at        DateTime @updatedAt

  @@map("entity_links")
  @@unique([source_entity_id, target_entity_id, relationship_type])
}

// Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø°ÙƒÙŠØ© ÙÙŠ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª
model SmartArticleLinks {
  id              String   @id @default(cuid())
  article_id      String   // Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ù‚Ø§Ù„
  entity_id       String

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ø§Ù„Ù†Øµ
  matched_text    String   // Ø§Ù„Ù†Øµ Ø§Ù„Ø°ÙŠ ØªÙ… Ø±Ø¨Ø·Ù‡
  context_before  String?  // Ø§Ù„Ø³ÙŠØ§Ù‚ Ù‚Ø¨Ù„ Ø§Ù„ÙƒÙ„Ù…Ø©
  context_after   String?  // Ø§Ù„Ø³ÙŠØ§Ù‚ Ø¨Ø¹Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø©
  position        Int      // Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ø§Ù„Ù†Øµ
  confidence      Float    @default(1.0) // Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ù‚Ø© ÙÙŠ Ø§Ù„Ø±Ø¨Ø·

  // Ù†ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø·
  link_type       String   // entity, tooltip, modal, external
  target_url      String?  // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù
  tooltip_content String?  // Ù…Ø­ØªÙˆÙ‰ tooltip

  // Ø­Ø§Ù„Ø© Ø§Ù„Ø±Ø§Ø¨Ø·
  is_approved     Boolean  @default(false) // Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø­Ø±Ø±
  is_active       Boolean  @default(true)
  auto_generated  Boolean  @default(true)  // ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹

  // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
  clicks          Int      @default(0)
  impressions     Int      @default(0)
  last_clicked    DateTime?

  entity          SmartEntities @relation(fields: [entity_id], references: [id])

  created_at      DateTime @default(now())
  updated_at      DateTime @updatedAt

  @@map("smart_article_links")
  @@index([article_id])
  @@index([entity_id])
  @@index([is_approved])
}

// Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ØµØ·Ù„Ø­Ø§Øª ÙˆØ§Ù„ØªØ¹Ø§Ø±ÙŠÙ
model SmartTerms {
  id              String   @id @default(cuid())

  term_ar         String?
  term_en         String?

  definition      String   // Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…Ø®ØªØµØ±
  detailed_def    String?  // Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ÙØµÙ„
  example         String?  // Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

  category        String?  // Ø§Ù‚ØªØµØ§Ø¯ÙŠØŒ Ø³ÙŠØ§Ø³ÙŠØŒ ØªÙ‚Ù†ÙŠØŒ Ø·Ø¨ÙŠ
  difficulty      String   @default("medium") // easy, medium, hard

  // Ù…Ø±Ø§Ø¯ÙØ§Øª
  synonyms        Json?    // ["Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù…Ø­Ù„ÙŠ", "GDP", "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù…Ø­Ù„ÙŠ"]

  // Ø±ÙˆØ§Ø¨Ø· Ø®Ø§Ø±Ø¬ÙŠØ©
  reference_url   String?
  wikipedia_url   String?

  usage_count     Int      @default(0)
  is_active       Boolean  @default(true)

  created_at      DateTime @default(now())
  updated_at      DateTime @updatedAt

  @@map("smart_terms")
  @@index([category])
  @@index([usage_count])
}

// Ø¬Ø¯ÙˆÙ„ ØªØªØ¨Ø¹ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø°ÙƒÙŠØ©
model LinkAnalytics {
  id              String   @id @default(cuid())
  link_id         String?  // Ù…Ø¹Ø±Ù Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø°ÙƒÙŠ
  article_id      String
  entity_id       String?

  // Ù†ÙˆØ¹ Ø§Ù„Ø­Ø¯Ø«
  event_type      String   // click, impression, hover, copy

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù…Ø¬Ù‡ÙˆÙ„Ø©)
  user_agent      String?
  ip_hash         String?  // hash Ù„Ù„Ù€ IP
  session_id      String?

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³ÙŠØ§Ù‚
  referrer        String?
  time_on_page    Int?     // Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ
  scroll_depth    Float?   // 0.0 - 1.0

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²
  device_type     String?  // mobile, desktop, tablet
  browser_type    String?

  timestamp       DateTime @default(now())

  @@map("link_analytics")
  @@index([article_id])
  @@index([entity_id])
  @@index([event_type])
  @@index([timestamp])
}

// ğŸ¯ ============ ÙˆØ­Ø¯Ø© Ù…ÙÙ‚ØªØ±ÙØ¨ (Muqtarab) ============ //

// Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
model MuqtarabCorner {
  id            String   @id @default(cuid())
  name          String   // Ø§Ø³Ù… Ø§Ù„Ø²Ø§ÙˆÙŠØ©
  slug          String   @unique // Ø±Ø§Ø¨Ø· Ù…Ø®ØµØµ
  author_name   String   // Ø§Ø³Ù… Ø§Ù„ÙƒØ§ØªØ¨ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
  author_bio    String?  // Ù†Ø¨Ø°Ø© Ø¹Ù† Ø§Ù„ÙƒØ§ØªØ¨
  cover_image   String?  // ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù
  description   String?  // ÙˆØµÙ Ø§Ù„Ø²Ø§ÙˆÙŠØ©

  // Ø§Ù„ØªØµÙ†ÙŠÙ
  category_id   String?
  category      categories? @relation(fields: [category_id], references: [id])

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
  ai_enabled    Boolean  @default(true)

  // Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø§ÙˆÙŠØ©
  is_active     Boolean  @default(true)
  is_featured   Boolean  @default(false)

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
  created_by    String?
  creator       users?   @relation(fields: [created_by], references: [id])

  // Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
  created_at    DateTime @default(now())
  updated_at    DateTime @updatedAt

  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  articles      MuqtarabArticle[]
  analytics     MuqtarabAnalytics[]
  followers     MuqtarabFollower[]

  @@map("muqtarab_corners")
  @@index([slug])
  @@index([is_active])
  @@index([created_by])
  @@index([category_id])
}

// Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª/Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹
model MuqtarabArticle {
  id                    String   @id @default(cuid())

  // Ø±Ø¨Ø· Ø¨Ø§Ù„Ø²Ø§ÙˆÙŠØ©
  corner_id             String
  corner                MuqtarabCorner @relation(fields: [corner_id], references: [id], onDelete: Cascade)

  // Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù‚Ø§Ù„
  title                 String   // Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
  slug                  String   @unique // Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù‚Ø§Ù„
  content               String   @db.Text // Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙƒØ§Ù…Ù„
  excerpt               String?  // Ù…Ù‚ØªØ·Ù
  cover_image           String?  // ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¤Ù„Ù
  author_name           String?  // ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ù…Ø®ØªÙ„Ù Ø¹Ù† ÙƒØ§ØªØ¨ Ø§Ù„Ø²Ø§ÙˆÙŠØ©
  author_bio            String?
  author_avatar         String?

  // Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©
  tags                  String[] // ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ© Ù„Ù„ØªÙˆØ§ÙÙ‚ Ù…Ø¹ ØªÙØ¶ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ù‚Ø§Ù„
  is_featured           Boolean  @default(false)
  read_time             Int?     // ÙˆÙ‚Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚

  // Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø© ÙˆØ§Ù„Ù†Ø´Ø±
  publish_at            DateTime?
  status                String   @default("draft") // draft, published, archived, scheduled

  // ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
  ai_sentiment          String?  // Ø³Ø§Ø®Ø±ØŒ ØªØ£Ù…Ù„ÙŠØŒ Ø¹Ø§Ø·ÙÙŠØŒ ØªØ­Ù„ÙŠÙ„ÙŠØŒ Ø¥Ù„Ù‡Ø§Ù…ÙŠ
  ai_compatibility_score Int?    @default(0) // Ù†Ø³Ø¨Ø© Ù…Ù„Ø§Ø¡Ù…Ø© 0-100
  ai_summary            String?  // Ù…Ù„Ø®Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠ
  ai_keywords           String[] // ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ© Ù…Ø³ØªØ®Ø±Ø¬Ø© Ø¨Ø§Ù„Ù€ AI
  ai_mood               String?  // Ø­Ø§Ù„Ø© Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø§Ù…Ø©

  // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø£Ø³Ø§Ø³ÙŠØ©
  view_count            Int      @default(0)
  like_count            Int      @default(0)
  share_count           Int      @default(0)
  comment_count         Int      @default(0)

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
  created_by            String?
  creator               users?   @relation(fields: [created_by], references: [id])

  // Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
  created_at            DateTime @default(now())
  updated_at            DateTime @updatedAt

  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  analytics             MuqtarabAnalytics[]
  interactions          MuqtarabInteraction[]
  comments              MuqtarabComment[]

  @@map("muqtarab_articles")
  @@index([corner_id])
  @@index([slug])
  @@index([status])
  @@index([publish_at])
  @@index([is_featured])
  @@index([ai_sentiment])
  @@index([created_by])
  @@index([created_at])
}

// Ø¬Ø¯ÙˆÙ„ ØªÙØ§Ø¹Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
model MuqtarabInteraction {
  id            String   @id @default(cuid())

  // Ø±Ø¨Ø· Ø¨Ø§Ù„Ù…Ù‚Ø§Ù„ ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  article_id    String
  article       MuqtarabArticle @relation(fields: [article_id], references: [id], onDelete: Cascade)

  user_id       String?
  user          users?   @relation(fields: [user_id], references: [id])

  // Ù†ÙˆØ¹ Ø§Ù„ØªÙØ§Ø¹Ù„
  interaction_type String // like, save, share, comment, follow_corner

  // Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
  metadata      Json?    // Ù„Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ØªÙØ§Ø¹Ù„

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø© (Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ØºÙŠØ± Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†)
  session_id    String?
  ip_hash       String?

  created_at    DateTime @default(now())

  @@map("muqtarab_interactions")
  @@index([article_id])
  @@index([user_id])
  @@index([interaction_type])
  @@index([session_id])
  @@unique([article_id, user_id, interaction_type])
}

// Ø¬Ø¯ÙˆÙ„ ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
model MuqtarabAnalytics {
  id                String   @id @default(cuid())

  // Ø±Ø¨Ø· Ø¨Ø§Ù„Ù…Ù‚Ø§Ù„ ÙˆØ§Ù„Ø²Ø§ÙˆÙŠØ©
  article_id        String?
  article           MuqtarabArticle? @relation(fields: [article_id], references: [id], onDelete: Cascade)

  corner_id         String?
  corner            MuqtarabCorner? @relation(fields: [corner_id], references: [id], onDelete: Cascade)

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  user_id           String?
  user              users?   @relation(fields: [user_id], references: [id])

  // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø©
  session_id        String?
  ip_hash           String?

  // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©
  view_duration     Int?     // Ù…Ø¯Ø© Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ
  scroll_depth      Float?   // Ø¹Ù…Ù‚ Ø§Ù„ØªÙ…Ø±ÙŠØ± (0.0 - 1.0)
  completion_rate   Float?   // Ù†Ø³Ø¨Ø© Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©

  // Ù…ØµØ¯Ø± Ø§Ù„ÙˆØµÙˆÙ„
  referrer_source   String?  // social, search, direct, internal
  referrer_url      String?
  utm_source        String?
  utm_medium        String?
  utm_campaign      String?

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²
  device_type       String?  // mobile, desktop, tablet
  browser_type      String?
  operating_system  String?
  screen_resolution String?

  // Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ (ØªÙ‚Ø±ÙŠØ¨ÙŠ)
  country_code      String?
  city              String?

  // ØªØ­Ù„ÙŠÙ„Ø§Øª Ø³Ù„ÙˆÙƒÙŠØ©
  bounce_rate       Boolean  @default(false) // Ù‡Ù„ ØºØ§Ø¯Ø± Ù…Ø¨Ø§Ø´Ø±Ø©ØŸ
  return_visitor    Boolean  @default(false) // Ø²Ø§Ø¦Ø± Ø¹Ø§Ø¦Ø¯ØŸ

  // ÙˆÙ‚Øª Ø§Ù„Ø²ÙŠØ§Ø±Ø©
  visit_hour        Int?     // Ø³Ø§Ø¹Ø© Ø§Ù„Ø²ÙŠØ§Ø±Ø© (0-23)
  visit_day         Int?     // ÙŠÙˆÙ… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ (1-7)

  created_at        DateTime @default(now())

  @@map("muqtarab_analytics")
  @@index([article_id])
  @@index([corner_id])
  @@index([user_id])
  @@index([session_id])
  @@index([referrer_source])
  @@index([device_type])
  @@index([created_at])
}

// Ø¬Ø¯ÙˆÙ„ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø²ÙˆØ§ÙŠØ§
model MuqtarabFollower {
  id         String   @id @default(cuid())

  // Ø±Ø¨Ø· Ø¨Ø§Ù„Ø²Ø§ÙˆÙŠØ© ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  corner_id  String
  corner     MuqtarabCorner @relation(fields: [corner_id], references: [id], onDelete: Cascade)

  user_id    String
  user       users    @relation(fields: [user_id], references: [id], onDelete: Cascade)

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
  notifications_enabled Boolean @default(true)
  email_notifications   Boolean @default(false)

  created_at DateTime @default(now())

  @@map("muqtarab_followers")
  @@unique([corner_id, user_id])
  @@index([corner_id])
  @@index([user_id])
}

// Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª (Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„)
model MuqtarabComment {
  id         String   @id @default(cuid())

  // Ø±Ø¨Ø· Ø¨Ø§Ù„Ù…Ù‚Ø§Ù„
  article_id String
  article    MuqtarabArticle @relation(fields: [article_id], references: [id], onDelete: Cascade)

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚
  user_id    String?
  user       users?   @relation(fields: [user_id], references: [id])

  // Ù„Ù„Ø²ÙˆØ§Ø± ØºÙŠØ± Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†
  guest_name  String?
  guest_email String?

  // Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚
  content    String   @db.Text

  // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚
  is_approved Boolean @default(false)
  is_hidden   Boolean @default(false)

  // Ø±Ø¯ Ø¹Ù„Ù‰ ØªØ¹Ù„ÙŠÙ‚ Ø¢Ø®Ø±
  parent_id  String?
  parent     MuqtarabComment? @relation("CommentReplies", fields: [parent_id], references: [id])
  replies    MuqtarabComment[] @relation("CommentReplies")

  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  @@map("muqtarab_comments")
  @@index([article_id])
  @@index([user_id])
  @@index([is_approved])
  @@index([created_at])
}

// ========== Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒØªÙ‘Ø§Ø¨ ÙˆÙ‚Ø§Ø¯Ø© Ø§Ù„Ø±Ø£ÙŠ ==========

model article_authors {
  id               String             @id
  full_name        String             @db.VarChar(255)
  slug             String             @unique @db.VarChar(255)
  title            String?            @db.VarChar(200) // Ø®Ø¨ÙŠØ±ØŒ Ø¯ÙƒØªÙˆØ±ØŒ Ù…Ø­Ù„Ù„
  bio              String?
  email            String?            @db.VarChar(255)
  avatar_url       String?
  social_links     Json?              @default("{}")
  is_active        Boolean            @default(true)
  role             String             @default("writer") @db.VarChar(50)
  specializations  String[]           // Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„ØªÙŠ ÙŠÙƒØªØ¨ ÙÙŠÙ‡Ø§
  total_articles   Int                @default(0)
  total_views      Int                @default(0)
  total_likes      Int                @default(0)
  total_shares     Int                @default(0)
  ai_score         Float              @default(0.0) // Ù†Ù‚Ø§Ø· Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
  last_article_at  DateTime?
  created_at       DateTime           @default(now())
  updated_at       DateTime           @updatedAt

  // Relationships
  articles         articles[]
  author_analytics author_analytics[]

  @@index([slug])
  @@index([is_active])
}

model article_quotes {
  id             String   @id
  article_id     String
  quote_text     String
  quote_order    Int      @default(0)
  ai_confidence  Float    @default(0.0)
  is_featured    Boolean  @default(false)
  created_at     DateTime @default(now())

  // Relationships
  article        articles @relation(fields: [article_id], references: [id], onDelete: Cascade)

  @@index([article_id])
}

model author_analytics {
  id               String          @id
  author_id        String
  date             DateTime        @db.Date
  articles_published Int           @default(0)
  total_views      Int             @default(0)
  total_likes      Int             @default(0)
  total_shares     Int             @default(0)
  engagement_rate  Float           @default(0.0)
  reading_time_avg Float           @default(0.0)
  created_at       DateTime        @default(now())
  updated_at       DateTime        @updatedAt

  // Relationships
  author           article_authors @relation(fields: [author_id], references: [id], onDelete: Cascade)

  @@unique([author_id, date])
  @@index([author_id, date])
}

// ============================================================
// ğŸ§  ÙˆØ­Ø¯Ø© Ø§Ù„Ø¬Ø±Ø¹Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© (Smart Daily Doses) - Ø¬Ø¯Ø§ÙˆÙ„ Ø¥Ø¶Ø§ÙÙŠØ©
// ============================================================

enum DoseReaction {
  like      // ğŸ‘
  dislike   // ğŸ‘
  neutral   // Ø¨Ø¯ÙˆÙ† ØªÙØ§Ø¹Ù„
  shared    // Ù…Ø´Ø§Ø±ÙƒØ©
  saved     // Ø­ÙØ¸
}

// Ø¬Ø¯ÙˆÙ„ ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ø¹ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª
model smart_dose_feedback {
  id            String        @id @default(cuid())

  // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ù„Ø¬Ø±Ø¹Ø©
  user_id       String
  user          users         @relation("DoseFeedbackUser", fields: [user_id], references: [id], onDelete: Cascade)
  dose_id       String
  dose          daily_doses   @relation(fields: [dose_id], references: [id], onDelete: Cascade)

  // Ù†ÙˆØ¹ Ø§Ù„ØªÙØ§Ø¹Ù„
  reaction      DoseReaction  @default(neutral)
  shared        Boolean       @default(false)
  saved         Boolean       @default(false)

  // Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„Ø³Ù„ÙˆÙƒ
  time_spent    Int?          // Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ
  read_percentage Float?      // Ù†Ø³Ø¨Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© (0-1)

  // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
  comment       String?       // ØªØ¹Ù„ÙŠÙ‚ Ø§Ø®ØªÙŠØ§Ø±ÙŠ
  platform      String?       // Ù…Ù†ØµØ© Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©

  created_at    DateTime      @default(now())
  updated_at    DateTime      @updatedAt

  @@unique([user_id, dose_id]) // ØªÙØ§Ø¹Ù„ ÙˆØ§Ø­Ø¯ Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¹ ÙƒÙ„ Ø¬Ø±Ø¹Ø©
  @@index([dose_id, reaction])
  @@index([user_id, created_at])
}

// Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©
model smart_dose_templates {
  id              String               @id @default(cuid())

  // Ø§Ù„ØªØµÙ†ÙŠÙ
  period          daily_doses_period
  template_name   String               // "ØµØ¨Ø§Ø­ Ø§Ù„Ù†Ø´Ø§Ø·", "Ù…ÙˆØ¬Ø² Ù…Ù†ØªØµÙ Ø§Ù„ÙŠÙˆÙ…"

  // Ø§Ù„Ù…Ø­ØªÙˆÙ‰
  main_text       String               // Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
  sub_text        String               // Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙØ±Ø¹ÙŠ

  // Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
  usage_count     Int                  @default(0)
  is_active       Boolean              @default(true)
  priority        Int                  @default(1) // Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ø¸Ù‡ÙˆØ±

  // Ø§Ù„ØªØ­Ø±ÙŠØ±
  created_by      String
  creator         users                @relation("DoseTemplateCreator", fields: [created_by], references: [id])

  created_at      DateTime             @default(now())
  updated_at      DateTime             @updatedAt

  @@index([period, is_active])
  @@index([priority, period])
}

// Ø¬Ø¯ÙˆÙ„ Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
model user_interests {
  id          Int       @id @default(autoincrement())
  user_id     String
  category_id String
  is_active   Boolean   @default(true)
  created_at  DateTime  @default(now())
  updated_at  DateTime  @updatedAt

  // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª
  user        users      @relation(fields: [user_id], references: [id], onDelete: Cascade)
  category    categories @relation(fields: [category_id], references: [id], onDelete: Cascade)

  @@unique([user_id, category_id])
  @@index([user_id])
  @@index([category_id])
  @@index([is_active])
}
