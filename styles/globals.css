/* استيراد نظام الوضع الليلي الموحد */
@import "./unified-dark-mode.css";
@import "./dark-mode-fixes.css";
@import "./header-dark-mode.css";

/* أنيميشن شعلة اللهب للأخبار الشائعة */
@keyframes flameFlicker {
  0% {
    transform: scale(1) rotate(-1deg);
    opacity: 0.9;
  }
  25% {
    transform: scale(1.1) rotate(1deg);
    opacity: 1;
  }
  50% {
    transform: scale(1.05) rotate(-0.5deg);
    opacity: 0.95;
  }
  75% {
    transform: scale(0.98) rotate(1.5deg);
    opacity: 1;
  }
  100% {
    transform: scale(0.95) rotate(-0.5deg);
    opacity: 0.9;
  }
}

.flame-main {
  animation: flameFlicker 1.5s ease-in-out infinite alternate;
}

.flame-inner {
  animation: flameFlicker 1.2s ease-in-out infinite alternate-reverse;
}

.flame-container:hover .flame-main,
.flame-container:hover .flame-inner {
  animation-duration: 0.8s;
}

/* حركات انزلاق صحيحة */
@keyframes slide-in-from-right { from { transform: translateX(100%);} to { transform: translateX(0);} }
@keyframes slide-out-to-right { from { transform: translateX(0);} to { transform: translateX(100%);} }

/* إزالة تكرار تعريف flameFlicker المكرر */

.data-\[state\=open\]\:slide-in-from-right[data-state="open"] { animation: slide-in-from-right 220ms cubic-bezier(0.2,0.8,0.2,1); }
.data-\[state\=closed\]\:slide-out-to-right[data-state="closed"] { animation: slide-out-to-right 200ms ease; }

/* إصلاحات الأخطاء والمشاكل العامة */
/* تصحيح أنماط الصور المكسورة */
img[src=""],
img:not([src]),
img[src*="800x600.jpg"] {
  display: none !important;
}

/* إخفاء عناصر "مجدول" */
[data-status="scheduled"],
.scheduled-indicator,
.status-scheduled {
  display: none !important;
}

/* فلترة الأخبار المجدولة */
.article-card[data-status="scheduled"],
.news-card[data-status="scheduled"] {
  display: none !important;
}

/* متغيرات CSS لأبعاد العناصر الثابتة */
:root {
  --header-height: 64px; /* ارتفاع الهيدر الرئيسي */
  --mobile-header-height: 56px; /* ارتفاع الهيدر للموبايل */
  --dashboard-header-height: 72px; /* ارتفاع هيدر لوحة التحكم */
}

/* تعويض التمرير للهيدر الثابت - CSS فقط بدون JavaScript */
html {
  /* إزالة smooth scrolling لتحسين الأداء */
  scroll-padding-top: var(--header-height);
}

@media (max-width: 768px) {
  html {
    scroll-padding-top: var(--mobile-header-height);
  }
}

/* استخدام وحدات العرض الحديثة للموبايل */
.min-h-screen-safe {
  min-height: 100vh;
  min-height: 100svh; /* Small viewport height - أكثر استقرارا على الموبايل */
}

/* منع الـ overlays من حجب المحتوى */
.loading-skeleton {
  position: relative;
  z-index: 1; /* أقل من الهيدر */
}

/* تعويض التمرير للعناوين داخل المقالات */
.article-content h1,
.article-content h2,
.article-content h3,
.article-content h4,
.article-content h5,
.article-content h6,
[id] {
  scroll-margin-top: calc(var(--header-height) + 1rem);
}

@media (max-width: 768px) {
  .article-content h1,
  .article-content h2,
  .article-content h3,
  .article-content h4,
  .article-content h5,
  .article-content h6,
  [id] {
    scroll-margin-top: calc(var(--mobile-header-height) + 1rem);
  }
}

/* إلغاء الإطار الأزرق عند التركيز */
* {
  outline: none !important;
}

/* إلغاء إطار التركيز للروابط والأزرار */
a:focus,
a:focus-visible,
button:focus,
button:focus-visible,
[role="button"]:focus,
[role="button"]:focus-visible,
.focus\:outline-none:focus,
.focus\:ring-0:focus,
.focus\:ring-2:focus,
.focus\:ring-4:focus,
.focus\:ring:focus,
.focus\:border-blue-500:focus,
.focus\:border-blue-600:focus {
  outline: none !important;
  box-shadow: none !important;
}

/* إلغاء الحلقة الزرقاء من Tailwind */
*:focus {
  --tw-ring-shadow: 0 0 #0000 !important;
  --tw-ring-offset-shadow: 0 0 #0000 !important;
  box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow),
    var(--tw-shadow, 0 0 #0000) !important;
}

/* إلغاء تأثيرات التركيز للبطاقات */
.card:focus,
.card:focus-visible,
[class*="card"]:focus,
[class*="card"]:focus-visible {
  outline: none !important;
  border-color: inherit !important;
}

/* إلغاء تأثيرات التركيز للقوائم المنسدلة */
.dropdown:focus,
.dropdown:focus-visible,
[class*="dropdown"]:focus,
[class*="dropdown"]:focus-visible,
select:focus,
select:focus-visible {
  outline: none !important;
  border-color: inherit !important;
}

@media (max-width: 768px) {
  :root {
    --header-height: 56px;
  }
}

/* التطبيق الموحّد للهيدر - إضافة تباعد أعلى المحتوى مع مسافة إضافية */
.page-content-wrapper {
  padding-top: calc(var(--header-height) + 1.5rem) !important; /* إضافة 24px مسافة إضافية */
  margin-top: 0 !important;
  min-height: 100vh;
  position: relative;
  z-index: 1;
}

@media (max-width: 768px) {
  .page-content-wrapper {
    padding-top: calc(var(--mobile-header-height) + 1rem) !important; /* إضافة 16px للموبايل */
  }
}

/* أول عنصر في المحتوى يبدأ من الأعلى مباشرة دون مضاعفة المسافة */
.page-content-wrapper > * {
  position: relative;
}

/* استثناء العناصر التي لها كلاس pulse-first-element */
.page-content-wrapper > *:first-child:not(.pulse-first-element) {
  margin-top: 0 !important;
}

/* تخصيص عناصر pulse-first-element لتكون ملاصقة للهيدر */
.page-content-wrapper > .pulse-first-element {
  margin-top: 0 !important;
}

@media (max-width: 768px) {
  .page-content-wrapper > *:first-child:not(.pulse-first-element) {
    padding-top: 0 !important;
  }

  .page-content-wrapper > .pulse-first-element {
    margin-top: 0 !important;
  }
}

.dashboard-content-wrapper {
  padding-top: var(--dashboard-header-height);
  min-height: calc(100vh - var(--dashboard-header-height));
}

/* التأكد من العرض الكامل للوحة التحكم */
.admin-dashboard-layout {
  width: 100% !important;
  max-width: none !important;
}

/* استثناء المحتوى الرئيسي الذي يحتاج لحجز مساحة للسايدبار */
.admin-dashboard-layout main:not(.admin-modern-main) {
  width: 100% !important;
  max-width: none !important;
}

/* فرض العرض الكامل داخل صفحات الإدارة بغض النظر عن container/max-w */
.admin-dashboard-layout main .container,
.admin-dashboard-layout main [class*="max-w-"] {
  max-width: none !important;
  width: 100% !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
  padding-left: 0 !important;
  padding-right: 0 !important;
}

/* 
  ==============================================
  FIX: إلغاء العرض الثابت للوحة التحكم (Responsive Dashboard Fix)
  - هذه القاعدة تلغي تأثير max-width: 1280px الذي يفرضه .container
  - على الشاشات الكبيرة، مما يسمح للوحة التحكم بالتمدد بشكل كامل.
  ==============================================
*/
.admin-dashboard-layout .container {
  max-width: 100% !important;
  width: 100% !important;
  margin-left: auto !important;
  margin-right: auto !important;
}

/* Force override for any tailwind-like max-w-* utility inside admin layout */
.admin-dashboard-layout [class*="max-w-"]:not(.admin-modern-main) {
  max-width: 100% !important;
  width: 100% !important;
}

/* Also neutralize inline style attributes that might set width via style="max-width: ..." */
.admin-dashboard-layout [style*="max-width"]:not(.admin-modern-main) {
  max-width: 100% !important;
  width: 100% !important;
}



/* الجداول داخل صفحات الإدارة تمتد لعرض المحتوى كاملاً */
.admin-dashboard-layout main table {
  width: 100% !important;
}

/* إصلاح نهائي ومحدود للصفحات الإدارية فقط */
@media (min-width: 768px) {
  /* يطبق فقط على الصفحات التي تحتوي على الشريط الجانبي الإداري */
  body:has(.manus-sidebar) .admin-modern-main.admin-dashboard-layout {
    width: calc(100vw - 300px) !important; 
    margin-right: 0 !important;
    padding-right: 0 !important; 
    max-width: none !important; 
    box-sizing: border-box !important;
    position: relative !important; 
  }
  
  /* إزالة أي margin أو padding من العناصر المرتبطة - للصفحات الإدارية فقط */
  body:has(.manus-sidebar) .admin-modern-main.admin-dashboard-layout + *,
  body:has(.manus-sidebar) .admin-modern-main.admin-dashboard-layout ~ * {
    margin-right: 0 !important;
    padding-right: 0 !important;
  }
  
  /* إزالة padding من العنصر الأب - للصفحات الإدارية فقط */
  body:has(.manus-sidebar) div:has(> .admin-modern-main.admin-dashboard-layout),
  body:has(.manus-sidebar) .admin-modern-main.admin-dashboard-layout > div,
  body:has(.manus-sidebar) .admin-modern-main.admin-dashboard-layout .container {
    padding-right: 0 !important;
    margin-right: 0 !important;
    width: 100% !important;
  }
  
  /* التأكد من أن body لا يحتوي على padding - للصفحات الإدارية فقط */
  body:has(.manus-sidebar):has(.admin-modern-main.admin-dashboard-layout) {
    padding-right: 0 !important;
  }
  
  /* حل إضافي للعناصر العنيدة - للصفحات الإدارية فقط */
  body:has(.manus-sidebar) .admin-modern-main.admin-dashboard-layout *[style*="padding-right"],
  body:has(.manus-sidebar) .admin-modern-main.admin-dashboard-layout *[style*="margin-right"] {
    padding-right: 0 !important;
    margin-right: 0 !important;
  }
}

/* للشاشات الصغيرة - التأكد من عدم وجود مشاكل في الصفحات الإدارية فقط */
@media (max-width: 767px) {
  body:has(.manus-sidebar) .admin-modern-main.admin-dashboard-layout {
    width: 100% !important;
    margin-right: 0 !important;
    padding-right: 0 !important;
  }
}

/* قاعدة احترازية إضافية لحماية الصفحة الرئيسية */
body:not(:has(.admin-modern-main)) .max-w-6xl,
body:not(:has(.admin-modern-main)) main,
body:not(:has(.admin-modern-main)) .container {
  /* التأكد من عدم تأثر الصفحة الرئيسية */
  position: static !important;
  width: auto !important;
  margin-left: auto !important;
  margin-right: auto !important;
}

/* تصحيح موضع الهيدر الثابت */
.fixed-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: var(--header-height);
  z-index: 40; /* فوق المحتوى وأقل من المودال */
}

.sticky-header {
  position: sticky;
  top: 0;
  height: var(--header-height);
  z-index: 50;
}

/* Modal و Dropdown z-indexes */
.modal-overlay {
  z-index: 60;
}

.dropdown-menu {
  z-index: 55;
}

/* تصحيح للصفحات التي تستخدم scroll */
html {
  scroll-padding-top: var(--header-height);
}

/* دعم الأجهزة بشاشات صغيرة */
@supports (padding: max(0px)) {
  .page-content-wrapper {
    padding-top: max(var(--header-height), env(safe-area-inset-top));
  }
}

@tailwind base;
@tailwind components;
@tailwind utilities;

/* إلغاء تأثيرات underline على الروابط */
@import "./no-link-underline.css";

/* تحسينات تجربة المستخدم */
@import "./enhanced-responsive.css";

/* معالجة الأخطاء */
@import "./error-handling.css";

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: "IBM Plex Sans Arabic", "Tajawal", "Noto Sans Arabic", system-ui,
    sans-serif !important;
}

html,
body {
  max-width: 100vw;
  overflow-x: hidden;
  direction: rtl;
  text-align: right;
}

body {
  color: #1a202c;
  background: #fafafa;
  font-family: "IBM Plex Sans Arabic", "Tajawal", "Noto Sans Arabic", system-ui,
    sans-serif !important;
  line-height: 1.7;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: "IBM Plex Sans Arabic", "Tajawal", "Noto Sans Arabic", system-ui,
    sans-serif !important;
  font-weight: 700;
  line-height: 1.3;
}

p,
div,
span {
  font-family: "IBM Plex Sans Arabic", "Tajawal", "Noto Sans Arabic", system-ui,
    sans-serif !important;
  line-height: 1.7;
}

a {
  color: inherit;
  text-decoration: none;
}

button {
  font-family: "IBM Plex Sans Arabic", "Tajawal", "Noto Sans Arabic", system-ui,
    sans-serif !important;
}

input,
textarea,
select {
  font-family: "IBM Plex Sans Arabic", "Tajawal", "Noto Sans Arabic", system-ui,
    sans-serif !important;
}

.article-content {
  font-family: "IBM Plex Sans Arabic", "Tajawal", "Noto Sans Arabic", system-ui,
    sans-serif !important;
  line-height: 1.8;
  text-align: right;
  direction: rtl;
}

.article-content h1,
.article-content h2,
.article-content h3 {
  font-family: "IBM Plex Sans Arabic", "Tajawal", "Noto Sans Arabic", system-ui,
    sans-serif !important;
  font-weight: 700;
}

/* تخصيص H2 للنسخة الخفيفة - حجم أصغر وليس bold */
.article-content h2 {
  font-size: 1.25rem !important; /* أصغر من الحجم الافتراضي */
  font-weight: 400 !important; /* عادي وليس bold */
  line-height: 1.4 !important;
  margin: 1.5rem 0 1rem 0 !important;
  color: #374151 !important; /* لون رمادي داكن */
}

.article-content p {
  font-family: "IBM Plex Sans Arabic", "Tajawal", "Noto Sans Arabic", system-ui,
    sans-serif !important;
  margin-bottom: 1.5rem;
  text-align: right;
}

/* Dark mode improvements */
@layer components {
  /* فرض خلفية بيضاء لبطاقات الأخبار داخل بلك النسخة المطورة بالذكاء الاصطناعي */
  .smart-ai-grid article,
  .smart-ai-list article {
    @apply bg-white border border-[#f0f0ef];
    background-color: #ffffff !important;
    border-color: #f0f0ef !important;
  }

  .dark .smart-ai-grid article,
  .dark .smart-ai-list article {
    @apply bg-gray-800 border-gray-700;
  }

  /* لوحة التحكم - ألوان الوضع الليلي */
  .dark {
    color-scheme: dark;
  }

  /* تحسين التمرير في الوضع الليلي */
  .dark ::-webkit-scrollbar {
    background-color: #1f2937;
  }

  .dark ::-webkit-scrollbar-track {
    background-color: #1f2937;
  }

  .dark ::-webkit-scrollbar-thumb {
    background-color: #4b5563;
    border-radius: 0.25rem;
  }

  .dark ::-webkit-scrollbar-thumb:hover {
    background-color: #6b7280;
  }

  /* الظلال في الوضع الليلي */
  .dark .shadow-sm {
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.3);
  }

  .dark .shadow {
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.4), 0 1px 2px 0 rgba(0, 0, 0, 0.3);
  }

  .dark .shadow-md {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.4),
      0 2px 4px -1px rgba(0, 0, 0, 0.3);
  }

  .dark .shadow-lg {
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.4),
      0 4px 6px -2px rgba(0, 0, 0, 0.3);
  }

  /* تحسين الحواف والإطارات */
  .dark .border {
    border-color: rgba(75, 85, 99, 0.5);
  }

  /* أزرار الوضع الليلي */
  .dark .btn-primary {
    @apply bg-blue-600 hover:bg-blue-700 text-white;
  }

  .dark .btn-secondary {
    @apply bg-gray-700 hover:bg-gray-600 text-gray-100;
  }

  /* البطاقات في الوضع الليلي */
  .dark .card {
    @apply bg-gray-800 border-gray-700;
  }

  /* الإدخالات في الوضع الليلي */
  .dark input,
  .dark textarea,
  .dark select {
    @apply bg-gray-700 border-gray-600 text-gray-100 placeholder-gray-400;
  }

  .dark input:focus,
  .dark textarea:focus,
  .dark select:focus {
    @apply bg-gray-600 border-blue-500;
  }

  /* الجداول في الوضع الليلي */
  .dark table {
    @apply border-gray-700;
  }

  .dark th {
    @apply bg-gray-900 text-gray-300 border-gray-700;
  }

  .dark td {
    @apply border-gray-700;
  }

  .dark tr:hover {
    @apply bg-gray-800/50;
  }

  /* القوائم المنسدلة في الوضع الليلي */
  .dark [role="menu"],
  .dark [role="listbox"] {
    @apply bg-gray-800 border-gray-700;
  }

  .dark [role="menuitem"]:hover,
  .dark [role="option"]:hover {
    @apply bg-gray-700;
  }

  /* التحولات السلسة */
  * {
    @apply transition-colors duration-200;
  }

  /* منع التحول في الصور والأيقونات */
  img,
  svg,
  video,
  canvas,
  audio,
  iframe,
  embed,
  object {
    transition: none !important;
  }
}

/* تحسينات RTL مع الوضع الليلي */
.dark [dir="rtl"] .sidebar {
  @apply border-l-0 border-r border-gray-700;
}

.dark [dir="rtl"] .dropdown-menu {
  @apply origin-top-left;
}

/* تحسين الألوان للقراءة في الوضع الليلي */
.dark .text-muted {
  @apply text-gray-400;
}

.dark .text-primary {
  @apply text-blue-400;
}

.dark .text-success {
  @apply text-green-400;
}

.dark .text-warning {
  @apply text-yellow-400;
}

.dark .text-danger {
  @apply text-red-400;
}

/* تحسينات رأس قسم المحتوى الذكي للجوال */
@media (max-width: 480px) {
  .smart-section-title {
    font-size: 1.5rem !important; /* تصغير 25% من text-2xl */
    line-height: 1.4 !important;
    margin-bottom: 0.75rem !important;
  }

  .smart-section-subtext {
    font-size: 0.875rem !important; /* تصغير من text-sm */
    line-height: 1.5 !important;
    margin-bottom: 1rem !important;
  }

  .smart-ai-label {
    font-size: 0.75rem !important; /* تصغير الشارة */
    padding: 0.375rem 0.75rem !important;
  }

  .smart-section-header {
    padding-top: 0.75rem !important;
    padding-bottom: 0.5rem !important;
    margin-bottom: 1.5rem !important;
  }
}

@media (max-width: 380px) {
  /* للشاشات الصغيرة جداً - ضغط أكثر */
  .smart-section-title {
    font-size: 1.25rem !important; /* ضغط إضافي */
    line-height: 1.3 !important;
    margin-bottom: 0.5rem !important;
  }

  .smart-section-subtext {
    font-size: 0.8rem !important;
    line-height: 1.4 !important;
  }

  .smart-ai-label {
    font-size: 0.7rem !important;
    padding: 0.25rem 0.5rem !important;
    gap: 0.5rem !important;
  }

  .smart-ai-label .w-4 {
    width: 0.875rem !important;
    height: 0.875rem !important;
  }
}

/* إخفاء العناوين المتراكبة على صور الأخبار المميزة في الديسكتوب فقط - FORCE UPDATE 2025-08-15T17:40 */
@media (min-width: 768px) {
  /* استهداف شامل لجميع مكونات الأخبار المميزة */
  [class*="featured"] .absolute h1,
  [class*="featured"] .absolute h2,
  [class*="featured"] .absolute h3,
  [class*="Featured"] .absolute h1,
  [class*="Featured"] .absolute h2,
  [class*="Featured"] .absolute h3,
  .featured-carousel .absolute h1,
  .featured-carousel .absolute h2,
  .featured-carousel .absolute h3 {
    display: none !important;
  }
  
  /* استهداف محدد للعناوين المتراكبة على الصور */
  [class*="featured"] .absolute.z-20 h3,
  [class*="Featured"] .absolute.z-20 h3 {
    display: none !important;
  }
}
