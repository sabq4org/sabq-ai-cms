# 📰 تحسينات صفحة إدارة الأخبار

## 📋 التعديلات المطلوبة والمنفذة

### ✅ 1. حذف عمود "اسم الكاتب" كعمود مستقل
- **تم حذف** عمود الكاتب من الجدول
- **تم إضافة** اسم الكاتب أسفل عنوان الخبر بخط صغير
- **التنسيق**: `text-xs text-gray-400`
- **المحاذاة**: يمين مع العنوان

### ✅ 2. تعديل عرض التصنيف
- **قبل**: كان يعرض `category_id` كرقم (مثال: 5 أو 4)
- **بعد**: يعرض اسم التصنيف (`name_ar`) بدلاً من ID
- **التصميم**: شارة ملونة بخلفية اللون المحدد لكل تصنيف
- **لون النص**: يتم حسابه تلقائياً (أسود أو أبيض) حسب التباين

## 🎨 التصنيفات المتاحة
```javascript
const categories = {
  1: { name: 'محليات', color: '#EF4444' },     // أحمر
  2: { name: 'تقنية', color: '#8B5CF6' },      // بنفسجي
  3: { name: 'اقتصاد', color: '#10B981' },     // أخضر
  4: { name: 'رياضة', color: '#F59E0B' },      // برتقالي
  5: { name: 'سياسة', color: '#3B82F6' },      // أزرق
  6: { name: 'ترفيه', color: '#EC4899' },      // وردي
  7: { name: 'صحة', color: '#06B6D4' },        // سماوي
  8: { name: 'تعليم', color: '#6366F1' },      // نيلي
  9: { name: 'ثقافة', color: '#14B8A6' },      // تركوازي
  10: { name: 'دولي', color: '#F97316' }       // برتقالي فاتح
};
```

## 🔧 الدوال المضافة

### دالة حساب لون النص
```javascript
function getContrastColor(hexColor: string): string {
  // تحويل HEX إلى RGB
  const r = parseInt(hexColor.slice(1, 3), 16);
  const g = parseInt(hexColor.slice(3, 5), 16);
  const b = parseInt(hexColor.slice(5, 7), 16);
  
  // حساب اللمعان
  const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
  
  // إرجاع أسود أو أبيض حسب اللمعان
  return luminance > 0.5 ? '#000000' : '#FFFFFF';
}
```

## 📁 الملفات المعدلة
- `/app/dashboard/news/page.tsx` - صفحة إدارة الأخبار
- `/data/articles.json` - بيانات المقالات (إضافة أسماء الكتاب)

## 🖼️ مثال على الشكل النهائي

### قبل:
```
| العنوان | الكاتب | التصنيف | ... |
|---------|--------|---------|-----|
| خبر 1   | أحمد   | 5       | ... |
```

### بعد:
```
| العنوان                    | التصنيف    | ... |
|----------------------------|-----------|-----|
| خبر 1                      | [سياسة] 🔵 | ... |
| بواسطة أحمد                |           |     |
```

## ⚠️ ملاحظات مهمة
1. **البيانات**: يجب أن تحتوي المقالات على `author_name` في قاعدة البيانات
2. **التصنيفات**: يتم تحديد اسم ولون التصنيف بناءً على `category_id`
3. **الأداء**: الدالة تعمل محلياً دون الحاجة لطلبات إضافية

---
تم التحديث بتاريخ: 17/06/2025 

## التحسينات الأولية (تم تنفيذها)

### 1. حذف عمود المؤلف وإضافته أسفل العنوان
- **السابق**: عمود منفصل للمؤلف
- **الحالي**: اسم المؤلف يظهر أسفل العنوان بحجم خط صغير ولون رمادي

### 2. عرض أسماء التصنيفات بدلاً من المعرفات
- **السابق**: عرض category_id كرقم (مثل: 5، 4)
- **الحالي**: عرض اسم التصنيف مع لون مخصص لكل تصنيف

### 3. التصنيفات المتاحة (10 تصنيفات):
1. محليات - أحمر (#EF4444)
2. تقنية - بنفسجي (#8B5CF6)
3. اقتصاد - أخضر (#10B981)
4. رياضة - برتقالي (#F59E0B)
5. سياسة - أزرق (#3B82F6)
6. ترفيه - وردي (#EC4899)
7. صحة - سماوي (#06B6D4)
8. تعليم - نيلي (#6366F1)
9. ثقافة - أخضر مائي (#14B8A6)
10. دولي - برتقالي داكن (#F97316)

### 4. حساب لون النص التلقائي
- إضافة دالة `getContrastColor()` لحساب أفضل لون للنص (أسود/أبيض) بناءً على خلفية التصنيف

### 5. تحديث قائمة التصنيفات في الفلتر
- استخدام التصنيفات الحقيقية في قائمة الفلتر المنسدلة

## التحسينات الإضافية (تم تنفيذها)

### 6. حذف بوتن "عاجل" و"مثبت" 
- **السابق**: بوتنات منفصلة تحت العنوان للأخبار العاجلة والمثبتة
- **الحالي**: استخدام ألوان خلفية وحدود جانبية للصفوف

### 7. حذف معرف المقال (#article-xxx)
- **السابق**: عرض معرف المقال أسفل العنوان
- **الحالي**: تم حذف المعرف نهائياً

### 8. إضافة تاريخ ووقت النشر تحت العنوان
- عرض تاريخ ووقت النشر مع أيقونة التقويم تحت اسم المؤلف
- استخدام التنسيق العربي للتاريخ والوقت

### 9. حذف عمود "وقت النشر" المنفصل
- **السابق**: عمود منفصل لوقت النشر
- **الحالي**: دمج التاريخ والوقت تحت العنوان مباشرة

### 10. تحسين مؤشرات الأخبار العاجلة والمثبتة
- **الأخبار العاجلة**: خلفية حمراء خفيفة مع حدود جانبية حمراء
- **الأخبار المثبتة**: خلفية زرقاء خفيفة مع حدود جانبية زرقاء
- دعم الوضع الليلي لجميع الألوان

## ملاحظات مهمة

### مشكلة التصنيف "غير مصنف"
إذا ظهر تصنيف "غير مصنف" لبعض المقالات، تحقق من:
1. وجود `category_id` صحيح في البيانات المحفوظة
2. أن القيمة رقمية بين 1-10
3. تحديث البيانات في `/data/articles.json` إذا لزم الأمر

### البيانات النموذجية
تم إضافة بيانات نموذجية تتضمن:
- أسماء مؤلفين مختلفة (محمد أحمد، فاطمة العلي، عبدالله الشمري، إلخ)
- تصنيفات متنوعة مع ألوان مخصصة
- أخبار عاجلة ومثبتة لاختبار التنسيق 

## التحسينات الأخيرة (تم تنفيذها)

### 11. إصلاح فلترة الأخبار في التابات
- **المشكلة**: الأخبار المحذوفة كانت تظهر في جميع التابات
- **الحل**: الأخبار المحذوفة تظهر فقط في تاب "المحذوفة"
- تحديث الأعداد في التابات لاستثناء المحذوفة

### 12. تصفير المشاهدات للمسودات
- **السابق**: المسودات تظهر بأرقام مشاهدات وهمية
- **الحالي**: المسودات تظهر بـ 0 مشاهدة دائماً

### 13. إرجاع عمود تاريخ النشر
- **السابق**: التاريخ تحت العنوان مع اسم المؤلف
- **الحالي**: عمود منفصل لتاريخ النشر بعد التصنيف

### 14. تصحيح رابط زر التعديل
- **السابق**: `/dashboard/news/edit/[id]`
- **الحالي**: `/dashboard/article/edit/[id]`
- إنشاء صفحة تعديل مؤقتة تعرض معرف المقال

### 15. تحديث الإحصائيات
- إجمالي الأخبار: لا يحسب المحذوفة
- الأخبار العاجلة: لا يحسب المحذوفة
- إجمالي المشاهدات: يحسب فقط المنشورة

## ملخص الفلترة الحالية

| التاب | الأخبار المعروضة |
|------|-----------------|
| جميع الأخبار | كل الأخبار ما عدا المحذوفة |
| منشور | فقط status = 'published' |
| مسودة | فقط status = 'draft' |
| عاجل | isBreaking = true وليست محذوفة |
| في الانتظار | فقط status = 'pending' |
| المحذوفة | فقط status = 'deleted' | 