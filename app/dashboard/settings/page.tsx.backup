'use client';

import React, { useState, useEffect } from 'react';
import { 
  Save,
  Upload,
  Globe,
  Shield,
  Brain,
  Database,
  Settings as SettingsIcon,
  Share2,
  Image,
  Type,
  Clock,
  Lock,
  Zap,
  Eye,
  EyeOff,
  RefreshCw,
  Download,
  AlertCircle,
  CheckCircle,
  X
} from 'lucide-react';

interface Setting {
  key: string;
  value: string | boolean | number;
  type: 'text' | 'textarea' | 'boolean' | 'number' | 'url' | 'email' | 'file' | 'select' | 'color';
  label: string;
  description?: string;
  category: string;
  options?: { value: string; label: string }[];
  required?: boolean;
}

export default function SettingsPage() {
  const [activeTab, setActiveTab] = useState('identity');
  const [darkMode, setDarkMode] = useState(false);
  const [settings, setSettings] = useState<Record<string, any>>({});
  const [saveStatus, setSaveStatus] = useState<'idle' | 'saving' | 'saved' | 'error'>('idle');
  const [unsavedChanges, setUnsavedChanges] = useState(false);

  // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
  useEffect(() => {
    const savedDarkMode = localStorage.getItem('darkMode');
    const savedSettings = localStorage.getItem('sabqSettings');
    
    if (savedDarkMode !== null) {
      setDarkMode(JSON.parse(savedDarkMode));
    }
    
    if (savedSettings) {
      setSettings(JSON.parse(savedSettings));
    } else {
      // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
      setSettings({
        site_name: 'ØµØ­ÙŠÙØ© Ø³Ø¨Ù‚ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©',
        site_description: 'Ø£Ø­Ø¯Ø« Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ÙˆØ§Ù„Ù…Ù‚Ø§Ù„Ø§Øª Ù…Ù† Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù„Ù…',
        site_url: 'https://sabq.org',
        default_language: 'ar',
        default_country: 'SA',
        timezone: 'Asia/Riyadh',
        meta_title: 'ØµØ­ÙŠÙØ© Ø³Ø¨Ù‚ - Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© ÙˆØ§Ù„Ø¹Ø§Ù„Ù…',
        meta_description: 'Ù…ÙˆÙ‚Ø¹ Ø¥Ø®Ø¨Ø§Ø±ÙŠ Ø´Ø§Ù…Ù„ ÙŠØºØ·ÙŠ Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…Ø­Ù„ÙŠØ© ÙˆØ§Ù„Ø¯ÙˆÙ„ÙŠØ©',
        meta_keywords: 'Ø£Ø®Ø¨Ø§Ø±ØŒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©ØŒ Ø³ÙŠØ§Ø³Ø©ØŒ Ø§Ù‚ØªØµØ§Ø¯ØŒ Ø±ÙŠØ§Ø¶Ø©ØŒ ØªÙ‚Ù†ÙŠØ©',
        articles_per_page: 8,
        auto_publish: false,
        editorial_review: true,
        ai_suggestions: true,
        backup_frequency: 'daily',
        two_factor_auth: false
      });
    }
  }, []);

  // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¬Ù…Ø¹Ø© Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø§Øª
  const settingsConfig: Setting[] = [
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù‡ÙˆÙŠØ©
    { key: 'site_name', value: '', type: 'text', label: 'Ø§Ø³Ù… Ø§Ù„ØµØ­ÙŠÙØ©', category: 'identity', required: true },
    { key: 'site_logo', value: '', type: 'file', label: 'Ø§Ù„Ø´Ø¹Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', category: 'identity', description: 'Ù…Ù„Ù PNG Ø£Ùˆ SVG' },
    { key: 'site_favicon', value: '', type: 'file', label: 'Ø§Ù„Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ØµØºØ±', category: 'identity', description: 'Ø£ÙŠÙ‚ÙˆÙ†Ø© 32x32 Ø¨ÙƒØ³Ù„' },
    { key: 'site_description', value: '', type: 'textarea', label: 'Ø§Ù„ÙˆØµÙ Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠ', category: 'identity' },
    { key: 'site_url', value: '', type: 'url', label: 'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ', category: 'identity', required: true },
    { key: 'default_language', value: 'ar', type: 'select', label: 'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©', category: 'identity', 
      options: [{ value: 'ar', label: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' }, { value: 'en', label: 'Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©' }] },
    { key: 'default_country', value: 'SA', type: 'select', label: 'Ø§Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©', category: 'identity',
      options: [{ value: 'SA', label: 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©' }, { value: 'AE', label: 'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª' }, { value: 'EG', label: 'Ù…ØµØ±' }] },
    { key: 'timezone', value: 'Asia/Riyadh', type: 'select', label: 'Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©', category: 'identity',
      options: [{ value: 'Asia/Riyadh', label: 'Asia/Riyadh' }, { value: 'Asia/Dubai', label: 'Asia/Dubai' }] },

    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª SEO
    { key: 'meta_title', value: '', type: 'text', label: 'Meta Title', category: 'seo', required: true },
    { key: 'meta_description', value: '', type: 'textarea', label: 'Meta Description', category: 'seo' },
    { key: 'meta_keywords', value: '', type: 'textarea', label: 'Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©', category: 'seo' },
    { key: 'og_image', value: '', type: 'file', label: 'ØµÙˆØ±Ø© OpenGraph', category: 'seo' },
    { key: 'og_type', value: 'website', type: 'select', label: 'Ù†ÙˆØ¹ OG', category: 'seo',
      options: [{ value: 'website', label: 'Website' }, { value: 'article', label: 'Article' }] },
    { key: 'canonical_url', value: '', type: 'url', label: 'Canonical URL', category: 'seo' },
    { key: 'auto_sitemap', value: true, type: 'boolean', label: 'ØªÙˆÙ„ÙŠØ¯ Sitemap ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹', category: 'seo' },

    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„
    { key: 'twitter_url', value: '', type: 'url', label: 'Ø±Ø§Ø¨Ø· ØªÙˆÙŠØªØ±', category: 'social' },
    { key: 'instagram_url', value: '', type: 'url', label: 'Ø±Ø§Ø¨Ø· Ø¥Ù†Ø³ØªØºØ±Ø§Ù…', category: 'social' },
    { key: 'facebook_url', value: '', type: 'url', label: 'Ø±Ø§Ø¨Ø· ÙÙŠØ³Ø¨ÙˆÙƒ', category: 'social' },
    { key: 'youtube_url', value: '', type: 'url', label: 'Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨', category: 'social' },
    { key: 'ios_app_url', value: '', type: 'url', label: 'ØªØ·Ø¨ÙŠÙ‚ iOS', category: 'social' },
    { key: 'android_app_url', value: '', type: 'url', label: 'ØªØ·Ø¨ÙŠÙ‚ Android', category: 'social' },
    { key: 'contact_email', value: '', type: 'email', label: 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø±Ø³Ù…ÙŠ', category: 'social' },
    { key: 'support_phone', value: '', type: 'text', label: 'Ø±Ù‚Ù… Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ', category: 'social' },

    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø­ØªÙˆÙ‰
    { key: 'auto_publish', value: false, type: 'boolean', label: 'ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹', category: 'content' },
    { key: 'editorial_review', value: true, type: 'boolean', label: 'ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªØ­Ø±ÙŠØ±ÙŠØ©', category: 'content' },
    { key: 'articles_per_page', value: 8, type: 'number', label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', category: 'content' },
    { key: 'breaking_news_duration', value: 90, type: 'number', label: 'Ù…Ø¯Ø© Ø¸Ù‡ÙˆØ± Ø§Ù„Ø®Ø¨Ø± Ø§Ù„Ø¹Ø§Ø¬Ù„ (Ø¯Ù‚Ø§Ø¦Ù‚)', category: 'content' },
    { key: 'auto_shorten_titles', value: false, type: 'boolean', label: 'ØªØµØºÙŠØ± Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹', category: 'content' },
    { key: 'show_read_count', value: true, type: 'boolean', label: 'Ø¹Ø±Ø¶ Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø§Øª', category: 'content' },
    { key: 'allow_comments', value: true, type: 'boolean', label: 'Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª', category: 'content' },
    { key: 'moderate_comments', value: true, type: 'boolean', label: 'Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ù†Ø´Ø±', category: 'content' },

    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
    { key: 'ai_enabled', value: true, type: 'boolean', label: 'ØªÙØ¹ÙŠÙ„ Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ', category: 'ai' },
    { key: 'openai_api_key', value: '', type: 'text', label: 'Ù…ÙØªØ§Ø­ OpenAI API', category: 'ai', description: 'sk-...' },
    { key: 'claude_api_key', value: '', type: 'text', label: 'Ù…ÙØªØ§Ø­ Claude API', category: 'ai', description: 'Claude Ù…Ù† Anthropic' },
    { key: 'gemini_api_key', value: '', type: 'text', label: 'Ù…ÙØªØ§Ø­ Gemini API', category: 'ai', description: 'Google Gemini' },
    { key: 'default_ai_model', value: 'gpt-3.5-turbo', type: 'select', label: 'Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ', category: 'ai',
      options: [
        { value: 'gpt-3.5-turbo', label: 'GPT-3.5 Turbo' },
        { value: 'gpt-4', label: 'GPT-4' },
        { value: 'gpt-4-turbo', label: 'GPT-4 Turbo' },
        { value: 'claude-3-sonnet', label: 'Claude 3 Sonnet' },
        { value: 'gemini-pro', label: 'Gemini Pro' }
      ] },
    { key: 'ai_temperature', value: 0.7, type: 'number', label: 'Ø¯Ø±Ø¬Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹ (0.0 - 1.0)', category: 'ai', description: 'Ù…Ø¯Ù‰ Ø¥Ø¨Ø¯Ø§Ø¹ÙŠØ© Ø§Ù„Ù†Øµ Ø§Ù„Ù…ÙÙˆÙ„Ø¯' },
    { key: 'ai_max_tokens', value: 1500, type: 'number', label: 'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„ØªÙˆÙƒÙ†Ø²', category: 'ai' },
    { key: 'ai_suggestions', value: true, type: 'boolean', label: 'ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© Ù…Ù† AI', category: 'ai' },
    { key: 'ai_summarization', value: true, type: 'boolean', label: 'ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙ„Ø®ÙŠØµ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ', category: 'ai' },
    { key: 'ai_keyword_extraction', value: true, type: 'boolean', label: 'Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©', category: 'ai' },
    { key: 'ai_content_rewrite', value: true, type: 'boolean', label: 'Ø¥Ø¹Ø§Ø¯Ø© ØµÙŠØ§ØºØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰', category: 'ai' },
    { key: 'ai_grammar_check', value: true, type: 'boolean', label: 'Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ù†Ø­ÙˆÙŠ ÙˆØ§Ù„Ø¥Ù…Ù„Ø§Ø¦ÙŠ', category: 'ai' },
    { key: 'ai_feedback', value: true, type: 'boolean', label: 'Ø¹Ø±Ø¶ Ø¥Ø´Ø§Ø±Ø§Øª AI Ù„Ù„Ù…Ø­Ø±Ø±', category: 'ai' },
    { key: 'ai_auto_mode', value: false, type: 'boolean', label: 'Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ù…ÙŠØ²Ø§Øª', category: 'ai' },
    { key: 'ai_manual_approval', value: true, type: 'boolean', label: 'Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„ÙŠØ¯ÙˆÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚', category: 'ai' },
    { key: 'ai_usage_limit', value: 100, type: 'number', label: 'Ø­Ø¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠ (Ø·Ù„Ø¨)', category: 'ai' },
    { key: 'ai_custom_model', value: false, type: 'boolean', label: 'Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ù…ÙˆØ°Ø¬ Ù…Ø®ØµØµ', category: 'ai' },
    { key: 'ai_output_language', value: 'auto', type: 'select', label: 'Ù„ØºØ© Ø¥Ø®Ø±Ø§Ø¬ AI', category: 'ai',
      options: [{ value: 'ar', label: 'Ø¹Ø±Ø¨ÙŠ' }, { value: 'en', label: 'Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ' }, { value: 'auto', label: 'ØªÙ„Ù‚Ø§Ø¦ÙŠ' }] },
    { key: 'ai_log_interactions', value: true, type: 'boolean', label: 'ØªØ³Ø¬ÙŠÙ„ ØªÙØ§Ø¹Ù„Ø§Øª AI', category: 'ai' },

    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†
    { key: 'two_factor_auth', value: false, type: 'boolean', label: 'ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø«Ù†Ø§Ø¦ÙŠØ© (2FA)', category: 'security' },
    { key: 'login_attempts', value: 3, type: 'number', label: 'Ø¹Ø¯Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©', category: 'security' },
    { key: 'allowed_ips', value: '', type: 'textarea', label: 'IPs Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø© (Ø³Ø·Ø± Ù…Ù†ÙØµÙ„ Ù„ÙƒÙ„ IP)', category: 'security' },
    { key: 'notify_settings_change', value: true, type: 'boolean', label: 'Ø¥Ø´Ø¹Ø§Ø± Ø¹Ù†Ø¯ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', category: 'security' },

    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
    { key: 'backup_frequency', value: 'daily', type: 'select', label: 'ØªÙƒØ±Ø§Ø± Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ', category: 'backup',
      options: [{ value: 'daily', label: 'ÙŠÙˆÙ…ÙŠ' }, { value: 'weekly', label: 'Ø£Ø³Ø¨ÙˆØ¹ÙŠ' }, { value: 'manual', label: 'ÙŠØ¯ÙˆÙŠ' }] },
    { key: 'backup_notifications', value: true, type: 'boolean', label: 'Ø¥Ø´Ø¹Ø§Ø± Ø¹Ù†Ø¯ ÙƒÙ„ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', category: 'backup' },
    { key: 'update_notifications', value: true, type: 'boolean', label: 'ØªÙ†Ø¨ÙŠÙ‡ Ø¹Ù†Ø¯ ØªÙˆÙØ± ØªØ­Ø¯ÙŠØ«', category: 'backup' },
    { key: 'settings_log', value: true, type: 'boolean', label: 'Ø­ÙØ¸ Ø³Ø¬Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª', category: 'backup' }
  ];

  // Ù…ÙƒÙˆÙ† Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠØ©
  const CircularStatsCard = ({ 
    title, 
    value, 
    subtitle, 
    icon: Icon, 
    bgColor,
    iconColor
  }: {
    title: string;
    value: string;
    subtitle: string;
    icon: any;
    bgColor: string;
    iconColor: string;
  }) => (
    <div className={`rounded-2xl p-6 shadow-sm border transition-colors duration-300 hover:shadow-md ${
      darkMode 
        ? 'bg-gray-800 border-gray-700' 
        : 'bg-white border-gray-100'
    }`}>
      <div className="flex items-center gap-4">
        <div className={`w-12 h-12 ${bgColor} rounded-full flex items-center justify-center`}>
          <Icon className={`w-6 h-6 ${iconColor}`} />
        </div>
        <div className="flex-1">
          <p className={`text-sm mb-1 transition-colors duration-300 ${
            darkMode ? 'text-gray-400' : 'text-gray-500'
          }`}>{title}</p>
          <div className="flex items-baseline gap-2">
            <span className={`text-2xl font-bold transition-colors duration-300 ${
              darkMode ? 'text-white' : 'text-gray-800'
            }`}>{value}</span>
            <span className={`text-sm transition-colors duration-300 ${
              darkMode ? 'text-gray-400' : 'text-gray-500'
            }`}>{subtitle}</span>
          </div>
        </div>
      </div>
    </div>
  );

  // Ù…ÙƒÙˆÙ† Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„
  const NavigationTabs = () => {
    const tabs = [
      { id: 'identity', name: 'Ø§Ù„Ù‡ÙˆÙŠØ©', icon: Type },
      { id: 'seo', name: 'SEO', icon: Globe },
      { id: 'social', name: 'Ø§Ù„ØªÙˆØ§ØµÙ„', icon: Share2 },
      { id: 'content', name: 'Ø§Ù„Ù…Ø­ØªÙˆÙ‰', icon: SettingsIcon },
      { id: 'ai', name: 'Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ', icon: Brain },
      { id: 'security', name: 'Ø§Ù„Ø£Ù…Ø§Ù†', icon: Shield },
      { id: 'backup', name: 'Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ', icon: Database }
    ];

    return (
      <div className={`rounded-2xl p-2 shadow-sm border mb-8 w-full transition-colors duration-300 ${
        darkMode 
          ? 'bg-gray-800 border-gray-700' 
          : 'bg-white border-gray-100'
      }`}>
        <div className="flex gap-2 justify-start pr-8">
          {tabs.map((tab) => {
            const Icon = tab.icon;
            return (
              <button
                key={tab.id}
                onClick={() => setActiveTab(tab.id)}
                className={`w-32 flex flex-col items-center justify-center gap-2 py-4 pb-3 px-3 rounded-xl font-medium text-sm transition-all duration-300 ${
                  activeTab === tab.id
                    ? 'bg-blue-500 text-white shadow-md border-b-4 border-blue-600'
                    : darkMode
                      ? 'text-gray-300 hover:bg-gray-700 border-b-4 border-transparent hover:border-gray-600'
                      : 'text-gray-600 hover:bg-gray-50 border-b-4 border-transparent hover:border-gray-200'
                }`}
                title={tab.name}
              >
                <Icon className="w-5 h-5" />
                <span className="leading-tight text-center">{tab.name}</span>
              </button>
            );
          })}
        </div>
      </div>
    );
  };

  // Ù…ÙƒÙˆÙ† Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
  const SettingField = ({ setting }: { setting: Setting }) => {
    const value = settings[setting.key] ?? setting.value;

    const handleChange = (newValue: any) => {
      setSettings(prev => ({ ...prev, [setting.key]: newValue }));
      setUnsavedChanges(true);
    };

    const fieldClass = `w-full px-4 py-2 rounded-xl border transition-colors duration-300 ${
      darkMode 
        ? 'bg-gray-700 border-gray-600 text-gray-200 focus:border-blue-500' 
        : 'bg-white border-gray-300 text-gray-900 focus:border-blue-500'
    } focus:outline-none focus:ring-1 focus:ring-blue-500`;

    return (
      <div className="mb-6">
        <label className={`block text-sm font-medium mb-2 transition-colors duration-300 ${
          darkMode ? 'text-gray-300' : 'text-gray-700'
        }`}>
          {setting.label}
          {setting.required && <span className="text-red-500 mr-1">*</span>}
        </label>
        
        {setting.type === 'text' && (
          <input
            type="text"
            value={value}
            onChange={(e) => handleChange(e.target.value)}
            className={fieldClass}
            required={setting.required}
          />
        )}
        
        {setting.type === 'textarea' && (
          <textarea
            value={value}
            onChange={(e) => handleChange(e.target.value)}
            rows={3}
            className={fieldClass}
          />
        )}
        
        {setting.type === 'number' && (
          <input
            type="number"
            value={value}
            onChange={(e) => handleChange(parseInt(e.target.value))}
            className={fieldClass}
            min="0"
          />
        )}
        
        {setting.type === 'url' && (
          <input
            type="url"
            value={value}
            onChange={(e) => handleChange(e.target.value)}
            className={fieldClass}
            placeholder="https://"
          />
        )}
        
        {setting.type === 'email' && (
          <input
            type="email"
            value={value}
            onChange={(e) => handleChange(e.target.value)}
            className={fieldClass}
            placeholder="example@domain.com"
          />
        )}
        
        {setting.type === 'boolean' && (
          <div className="flex items-center gap-3">
            <button
              onClick={() => handleChange(!value)}
              className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-300 ${
                value ? 'bg-blue-500' : darkMode ? 'bg-gray-600' : 'bg-gray-300'
              }`}
            >
              <span
                className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform duration-300 ${
                  value ? 'translate-x-6' : 'translate-x-1'
                }`}
              />
            </button>
            <span className={`text-sm transition-colors duration-300 ${
              darkMode ? 'text-gray-300' : 'text-gray-600'
            }`}>
              {value ? 'Ù…ÙØ¹Ù„' : 'ØºÙŠØ± Ù…ÙØ¹Ù„'}
            </span>
          </div>
        )}
        
        {setting.type === 'select' && (
          <select
            value={value}
            onChange={(e) => handleChange(e.target.value)}
            className={fieldClass}
          >
            {setting.options?.map(option => (
              <option key={option.value} value={option.value}>
                {option.label}
              </option>
            ))}
          </select>
        )}
        
        {setting.type === 'file' && (
          <div className="space-y-2">
            <input
              type="file"
              onChange={(e) => {
                const file = e.target.files?.[0];
                if (file) {
                  handleChange(file.name);
                }
              }}
              className={fieldClass}
              accept={setting.key.includes('logo') || setting.key.includes('image') ? 'image/*' : '*'}
            />
            {value && (
              <p className={`text-xs transition-colors duration-300 ${
                darkMode ? 'text-gray-400' : 'text-gray-500'
              }`}>
                Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø­Ø§Ù„ÙŠ: {value}
              </p>
            )}
                </div>
        )}
        
        {setting.description && (
          <p className={`text-xs mt-1 transition-colors duration-300 ${
            darkMode ? 'text-gray-400' : 'text-gray-500'
          }`}>
            {setting.description}
          </p>
        )}
              </div>
    );
  };

  // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
  const handleSave = async () => {
    setSaveStatus('saving');
    try {
      // Ù…Ø­Ø§ÙƒØ§Ø© API call
      await new Promise(resolve => setTimeout(resolve, 1000));
      localStorage.setItem('sabqSettings', JSON.stringify(settings));
      setSaveStatus('saved');
      setUnsavedChanges(false);
      setTimeout(() => setSaveStatus('idle'), 2000);
    } catch (error) {
      setSaveStatus('error');
      setTimeout(() => setSaveStatus('idle'), 2000);
    }
  };

  // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©
  const getSettingsByCategory = (category: string) => {
    return settingsConfig.filter(setting => setting.category === category);
  };

  // Ø¹Ø±Ø¶ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
  const renderTabContent = () => {
    const categorySettings = getSettingsByCategory(activeTab);
    
    return (
      <div className="space-y-6">
        {categorySettings.map(setting => (
          <SettingField key={setting.key} setting={setting} />
        ))}
      </div>
    );
  };

  return (
    <div className={`p-8 transition-colors duration-300 ${
      darkMode ? 'bg-gray-900' : ''
    }`}>
            {/* Ø¹Ù†ÙˆØ§Ù† ÙˆØªØ¹Ø±ÙŠÙ Ø§Ù„ØµÙØ­Ø© */}
      <div className="mb-8">
        <h1 className={`text-3xl font-bold mb-2 transition-colors duration-300 ${
          darkMode ? 'text-white' : 'text-gray-800'
        }`}>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµØ­ÙŠÙØ©</h1>
        <p className={`transition-colors duration-300 ${
          darkMode ? 'text-gray-300' : 'text-gray-600'
        }`}>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ùˆ SEO Ù„ØµØ­ÙŠÙØ© Ø³Ø¨Ù‚ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</p>
      </div>

      {/* Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */}
      <div className="grid grid-cols-7 gap-6 mb-8">
        <CircularStatsCard
          title="Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù‡ÙˆÙŠØ©"
          value="8"
          subtitle="Ø¥Ø¹Ø¯Ø§Ø¯"
          icon={Type}
          bgColor="bg-blue-100"
          iconColor="text-blue-600"
        />
        <CircularStatsCard
          title="Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª SEO"
          value="7"
          subtitle="Ø¥Ø¹Ø¯Ø§Ø¯"
          icon={Globe}
          bgColor="bg-green-100"
          iconColor="text-green-600"
        />
        <CircularStatsCard
          title="Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙˆØ§ØµÙ„"
          value="8"
          subtitle="Ø±Ø§Ø¨Ø·"
          icon={Share2}
          bgColor="bg-purple-100"
          iconColor="text-purple-600"
        />
        <CircularStatsCard
          title="Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø­ØªÙˆÙ‰"
          value="8"
          subtitle="Ø®ÙŠØ§Ø±"
          icon={SettingsIcon}
          bgColor="bg-orange-100"
          iconColor="text-orange-600"
        />
        <CircularStatsCard
          title="Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ"
          value="5"
          subtitle="Ù…ÙŠØ²Ø©"
          icon={Brain}
          bgColor="bg-cyan-100"
          iconColor="text-cyan-600"
        />
        <CircularStatsCard
          title="Ø§Ù„Ø£Ù…Ø§Ù†"
          value="4"
          subtitle="Ø­Ù…Ø§ÙŠØ©"
          icon={Shield}
          bgColor="bg-red-100"
          iconColor="text-red-600"
        />
        <CircularStatsCard
          title="Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ"
          value="4"
          subtitle="Ø®ÙŠØ§Ø±"
          icon={Database}
          bgColor="bg-indigo-100"
          iconColor="text-indigo-600"
        />
      </div>

      {/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ */}
        <NavigationTabs />

      {/* Ø´Ø±ÙŠØ· Ø§Ù„Ø­ÙØ¸ */}
      {unsavedChanges && (
        <div className={`rounded-2xl p-4 mb-6 border-l-4 border-yellow-500 transition-colors duration-300 ${
          darkMode ? 'bg-yellow-900/20 border-yellow-400' : 'bg-yellow-50'
        }`}>
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-2">
              <AlertCircle className="w-5 h-5 text-yellow-500" />
              <span className={`font-medium transition-colors duration-300 ${
                darkMode ? 'text-yellow-300' : 'text-yellow-700'
              }`}>
                Ù„Ø¯ÙŠÙƒ ØªØºÙŠÙŠØ±Ø§Øª ØºÙŠØ± Ù…Ø­ÙÙˆØ¸Ø©
              </span>
            </div>
            <button
              onClick={handleSave}
              disabled={saveStatus === 'saving'}
              className="px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50"
            >
              {saveStatus === 'saving' ? (
                <RefreshCw className="w-4 h-4 animate-spin" />
              ) : (
                <Save className="w-4 h-4" />
              )}
              {saveStatus === 'saving' ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...' : 'Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª'}
            </button>
          </div>
        </div>
      )}

      {/* Ø±Ø³Ø§Ù„Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø­ÙØ¸ */}
      {saveStatus === 'saved' && (
        <div className={`rounded-2xl p-4 mb-6 border-l-4 border-green-500 transition-colors duration-300 ${
          darkMode ? 'bg-green-900/20' : 'bg-green-50'
        }`}>
          <div className="flex items-center gap-2">
            <CheckCircle className="w-5 h-5 text-green-500" />
            <span className={`font-medium transition-colors duration-300 ${
              darkMode ? 'text-green-300' : 'text-green-700'
            }`}>
              ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­
            </span>
          </div>
        </div>
      )}

      {saveStatus === 'error' && (
        <div className={`rounded-2xl p-4 mb-6 border-l-4 border-red-500 transition-colors duration-300 ${
          darkMode ? 'bg-red-900/20' : 'bg-red-50'
        }`}>
          <div className="flex items-center gap-2">
            <X className="w-5 h-5 text-red-500" />
            <span className={`font-medium transition-colors duration-300 ${
              darkMode ? 'text-red-300' : 'text-red-700'
            }`}>
              Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
            </span>
          </div>
        </div>
      )}

      {/* Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */}
      <div className={`rounded-2xl shadow-sm border overflow-hidden transition-colors duration-300 ${
        darkMode ? 'bg-gray-800 border-gray-700' : 'bg-white border-gray-100'
      }`}>
        <div className="p-6">
          <div className="flex items-center gap-2 mb-6">
            {activeTab === 'identity' && <Type className="w-6 h-6 text-blue-500" />}
            {activeTab === 'seo' && <Globe className="w-6 h-6 text-green-500" />}
            {activeTab === 'social' && <Share2 className="w-6 h-6 text-purple-500" />}
            {activeTab === 'content' && <SettingsIcon className="w-6 h-6 text-orange-500" />}
            {activeTab === 'ai' && <Brain className="w-6 h-6 text-cyan-500" />}
            {activeTab === 'security' && <Shield className="w-6 h-6 text-red-500" />}
            {activeTab === 'backup' && <Database className="w-6 h-6 text-indigo-500" />}
            
            <h3 className={`text-xl font-bold transition-colors duration-300 ${
              darkMode ? 'text-white' : 'text-gray-800'
            }`}>
              {activeTab === 'identity' && 'âš¡ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù‡ÙˆÙŠØ©'}
              {activeTab === 'seo' && 'ğŸŒ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª SEO'}
              {activeTab === 'social' && 'ğŸ“± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„'}
              {activeTab === 'content' && 'ğŸ“ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø­ØªÙˆÙ‰'}
              {activeTab === 'ai' && 'ğŸ§  Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ'}
              {activeTab === 'security' && 'ğŸ” Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†'}
              {activeTab === 'backup' && 'ğŸ’¾ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ'}
            </h3>
          </div>
          
          {renderTabContent()}
        </div>
      </div>

      {/* Ø²Ø± Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ø³ÙÙ„ÙŠ */}
      <div className="mt-8 flex justify-end">
        <button
          onClick={handleSave}
          disabled={!unsavedChanges || saveStatus === 'saving'}
          className="px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          {saveStatus === 'saving' ? (
            <RefreshCw className="w-5 h-5 animate-spin" />
          ) : (
            <Save className="w-5 h-5" />
          )}
          {saveStatus === 'saving' ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...' : 'Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª'}
        </button>
      </div>
    </div>
  );
} 