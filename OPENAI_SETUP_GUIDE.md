# دليل إعداد مفتاح OpenAI API

## المشكلة
عند محاولة توليد تحليل عميق، تظهر رسالة الخطأ:
```
401 Incorrect API key provided: sk-....
```

## الحل

### 1. الحصول على مفتاح OpenAI API

1. اذهب إلى [OpenAI API Keys](https://platform.openai.com/api-keys)
2. سجل الدخول أو أنشئ حساب جديد
3. انقر على **"Create new secret key"**
4. أعط المفتاح اسماً وصفياً مثل "Sabq CMS"
5. انسخ المفتاح (يبدأ بـ `sk-`)
   - **مهم**: احفظ المفتاح في مكان آمن، لن تتمكن من رؤيته مرة أخرى!

### 2. إعداد المفتاح في المشروع

#### الطريقة الأولى: من خلال لوحة التحكم (موصى بها)

1. اذهب إلى [إعدادات الصحيفة](http://localhost:3000/dashboard/settings)
2. انقر على تبويب **"الذكاء الاصطناعي"**
3. الصق المفتاح في حقل **"مفتاح OpenAI API"**
4. انقر على زر **"اختبار"** للتحقق من صحة المفتاح
5. إذا ظهرت رسالة خضراء "تم الاتصال بنجاح!"، انقر على **"حفظ"**

#### الطريقة الثانية: إنشاء ملف .env

1. في المجلد الرئيسي للمشروع، أنشئ ملف جديد باسم `.env`
2. أضف السطر التالي واستبدل `YOUR_API_KEY` بمفتاحك الفعلي:
   ```
   OPENAI_API_KEY=sk-your-actual-api-key-here
   ```
3. احفظ الملف وأعد تشغيل السيرفر

### 3. التحقق من الإعداد

1. اذهب إلى صفحة إنشاء التحليل العميق
2. اختر نوع "GPT" أو "مختلط"
3. املأ البيانات المطلوبة
4. انقر على "توليد المحتوى بـ AI"

إذا كان المفتاح صحيحاً، سيتم توليد المحتوى بنجاح!

## استكشاف الأخطاء

### "مفتاح API غير صحيح"
- تأكد من نسخ المفتاح كاملاً بما في ذلك البادئة `sk-`
- تحقق من عدم وجود مسافات زائدة قبل أو بعد المفتاح
- تأكد من أن المفتاح لم ينته صلاحيته

### "تم تجاوز حد الاستخدام"
- تحقق من رصيدك في [OpenAI Usage](https://platform.openai.com/usage)
- قد تحتاج لإضافة طريقة دفع أو شحن رصيدك

### "خطأ في الاتصال"
- تحقق من اتصالك بالإنترنت
- قد تكون خدمة OpenAI غير متاحة مؤقتاً

## ملاحظات مهمة

- **الأمان**: لا تشارك مفتاح API مع أي شخص
- **Git**: تأكد من أن ملف `.env` مضاف إلى `.gitignore`
- **التكلفة**: استخدام OpenAI API له تكلفة، راقب استخدامك من [لوحة التحكم](https://platform.openai.com/usage)

## مثال لملف .env كامل

```env
# OpenAI API Key (مطلوب)
OPENAI_API_KEY=sk-proj-abcdefghijklmnopqrstuvwxyz123456789

# إعدادات أخرى (اختيارية)
NODE_ENV=development
NEXT_PUBLIC_SITE_URL=http://localhost:3000
``` 