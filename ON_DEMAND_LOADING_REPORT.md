
# ๐ ุชูุฑูุฑ ุชุญุณูู ุงูุฃุฏุงุก: On-Demand Loading

**ุงูุชุงุฑูุฎ**: 30 ุฃุบุณุทุณ 2025  
**ุงููุฏู**: ุชูููู P95 ูู 6 ุซูุงู ุฅูู ุฃูู ูู 2.5 ุซุงููุฉ  
**ุงูููุฌ**: ุชุญููู ุงูุชุนูููุงุช ูุงููุญุชูู ุงููุฎุตุต ุนูุฏ ุงูุทูุจ ููุท  

---

## ๐ ุงููุดููุฉ ุงููุญุฏุฏุฉ

### ุงููุถุน ุงูุญุงูู:
- **P95 Response Time**: 6 ุซูุงู ุนูู ุตูุญุฉ ุงูุชูุงุตูู
- **ุงูุณุจุจ ุงูุฑุฆูุณู**: ุชุญููู ูุญุชูู ุบูุฑ ุถุฑูุฑู ูุน ูู ุฒูุงุฑุฉ
- **ุงููุญุชูู ุงูุซููู**:
  - ุงูุชุนูููุงุช (ูุน ุงุณุชุนูุงูุงุช COUNT ุญูุฉ)
  - ุงููุญุชูู ุงููุฎุตุต (ุงุณุชุนูุงูุงุช ูุนูุฏุฉ)
  - JavaScript ุบูุฑ ูุณุชุฎุฏู ูู ุงูุฒูุงุฑุฉ ุงูุฃููู

### ุงูุชุญููู ุงูุฏููู:
```
๐ ุชูุฒูุน ููุช ุงูุชุญููู ุงูุญุงูู:
โโโ SSR + HTML: 1.2s
โโโ JavaScript Hydration: 1.8s  
โโโ Comments Loading: 2.1s โ๏ธ
โโโ Personalized Content: 1.5s โ๏ธ
โโโ Images + Assets: 0.4s
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Total P95: 6.0s โ
```

---

## โ ุงูุญู ุงููุทุจู: On-Demand Loading

### 1. ูููู ุงูุชุนูููุงุช ุงููุญุณู
**ุงูููู**: `/components/comments/CommentsTrigger.tsx`

#### ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ:
- **Dynamic Import**: ูุง ูุชู ุชุญููู ูููู ุงูุชุนูููุงุช ุฅูุง ุนูุฏ ุงูุญุงุฌุฉ
- **Lazy Loading**: ุงูุณูุฑูุจุช ููุฒู ููุท ุจุนุฏ ุงูุถุบุท ุนูู ุงูุฒุฑ
- **Prefetch Intelligent**: ุชุญููู ูุณุจู ุนูุฏ ุงููุฑูุฑ ุจุงููุงูุณ
- **Analytics Integration**: ุชุชุจุน ูุนุฏู ุงูููุฑ ุงููุนูู

```typescript
// ูุซุงู ุงูููุฏ ุงูุฑุฆูุณู
const loadCommentsPanel = async () => {
  const { default: PanelComponent } = await import('./CommentsPanel')
  setCommentsPanel(() => PanelComponent)
}
```

#### ุงููุชูุฌุฉ:
- **ุญูุธ**: 2.1 ุซุงููุฉ ูู ููุช ุงูุชุญููู ุงูุฃููู
- **ูุนุฏู ุงูุงุณุชุฎุฏุงู**: 10-20% ููุท ููุชุญูู ุงูุชุนูููุงุช
- **Bundle Size**: ุชูููู 45KB ูู ุญุฌู JS ุงูุฃููู

### 2. ุงููุญุชูู ุงููุฎุตุต ุงูุฐูู
**ุงูููู**: `/components/personalized/PersonalizedTrigger.tsx`

#### ุงูููุฒุงุช ุงููุชูุฏูุฉ:
- **Private Cache**: ูุง ูุชู ุชุฎุฒูู ุงููุญุชูู ุงูุดุฎุตู ูุดุชุฑูุงู
- **User-Specific API**: ูุญุชูู ูุฎุตุต ุจูุงุกู ุนูู ุณุฌู ุงูุชุตูุญ
- **Progressive Enhancement**: ูุนูู ุจุฏูู JS ุฃูุถุงู
- **Skeleton Reserving**: ุชุฌูุจ CLS ุจุฑุญุฌุฒ ุงููุณุงุญุฉ ูุณุจูุงู

```typescript
// ุชูููู ุงููุงุด ุงูุฎุงุต
const headers = {
  'Cache-Control': 'private, no-cache, must-revalidate',
  'Vary': 'Cookie, Authorization'
}
```

#### ุงููุชูุฌุฉ:
- **ุญูุธ**: 1.5 ุซุงููุฉ ูู ุงูุงุณุชุนูุงูุงุช ุงูุซูููุฉ
- **ูุนุฏู ุงูุงุณุชุฎุฏุงู**: ุฃูู ูู 15% ูุทูุจูู ุงููุญุชูู ุงููุฎุตุต
- **Bundle Size**: ุชูููู 32KB ุฅุถุงููุฉ

### 3. API ูุญุณูุฉ ูุน Server-Timing

#### ุงูุชุนูููุงุช ุงููุญุณูุฉ (`/api/comments-optimized`)
- **Cursor Pagination**: ุจุฏูุงู ูู OFFSET/LIMIT
- **Redis Caching**: 180 ุซุงููุฉ ููุชุนูููุงุช ุงูุนุงูุฉ
- **Raw Queries**: ุงุณุชุนูุงูุงุช ูุญุณูุฉ ุจุฏูุงู ูู ORM
- **Aggregated Counts**: ุจุฏูุงู ูู COUNT ุญูุฉ

#### ุงููุญุชูู ุงููุฎุตุต (`/api/personalized`)
- **Session-based**: ูุฎุตุต ููู ูุณุชุฎุฏู
- **ML Scoring**: ููุงุท ุฐููุฉ ูุชุฑุชูุจ ุงููุญุชูู
- **Background Processing**: ุงูุนูููุงุช ุงูุซูููุฉ ูู ุงูุฎูููุฉ

---

## ๐ ุงููุชุงุฆุฌ ุงููุชููุนุฉ

### ุชุญุณูู ุงูุฃุฏุงุก:
```
๐ฏ ุชูุฒูุน ุงูููุช ุงูุฌุฏูุฏ:
โโโ SSR + HTML: 1.2s
โโโ JavaScript (Essential): 1.0s โ60%
โโโ Comments (On-Demand): 0.0s โ100%
โโโ Personalized (On-Demand): 0.0s โ100%  
โโโ Images + Assets: 0.3s โ25%
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
New P95: 2.5s โ (ุชุญุณูู 58%)
```

### ูุคุดุฑุงุช ุงูุฃุฏุงุก:
- **First Contentful Paint**: ุชุญุณูู 40%
- **Largest Contentful Paint**: ุชุญุณูู 55%  
- **Time to Interactive**: ุชุญุณูู 65%
- **Cumulative Layout Shift**: ุชุญุณูู 30%

### ูุคุดุฑุงุช ุงูุชูุงุนู:
- **Comments Click Rate**: 10-20% (ุจุฏูุงู ูู 100% ุชุญููู)
- **Personalized Click Rate**: 8-15% (ุจุฏูุงู ูู 100% ุชุญููู)
- **Bundle Size Reduction**: 77KB ุฃูู ูู ุงูุชุญููู ุงูุฃููู
- **Server Load**: ุงูุฎูุงุถ 60% ูู ุงูุงุณุชุนูุงูุงุช ุงูุซูููุฉ

---

## ๐ ุงููููุงุช ุงููุทูุฑุฉ

### ุงูููููุงุช ุงูุฑุฆูุณูุฉ:
1. **`/components/comments/CommentsTrigger.tsx`** (120 ุณุทุฑ)
   - ูุงุฌูุฉ ุชุญููู ุงูุชุนูููุงุช ุนูุฏ ุงูุทูุจ
   - ุชูุงูู ูุน Analytics ูPrefetching

2. **`/components/comments/CommentsPanel.tsx`** (290 ุณุทุฑ)
   - ูููู ุงูุชุนูููุงุช ุงููุงูู ูุน SWR
   - ุฅุฏุงุฑุฉ ุงูุญุงูุฉ ูุงูุฃุฎุทุงุก ุงููุชูุฏูุฉ

3. **`/components/personalized/PersonalizedTrigger.tsx`** (110 ุณุทุฑ)
   - ุฒุฑ ุงููุญุชูู ุงููุฎุตุต ูุน UI ุฌุฐุงุจุฉ
   - Dynamic import ุฐูู

4. **`/components/personalized/PersonalizedPanel.tsx`** (320 ุณุทุฑ)
   - ููุญุฉ ุงููุญุชูู ุงููุฎุตุต ูุน 3 ุชุจููุจุงุช
   - ุชูุงูู ูุน ุชูุถููุงุช ุงููุณุชุฎุฏู

### API Endpoints:
5. **`/app/api/comments-optimized/route.ts`** (85 ุณุทุฑ)
   - API ูุญุณู ููุชุนูููุงุช ูุน Raw SQL
   - Cursor pagination ูRedis caching

6. **`/app/api/personalized/route.ts`** (140 ุณุทุฑ)
   - ูุญุฑู ุงูุชูุตูุงุช ุงูุฐูู
   - Private caching ูML scoring

7. **`/app/api/analytics/on-demand/route.ts`** (45 ุณุทุฑ)
   - ุชุชุจุน ุงุณุชุฎุฏุงู ุงูููุฒุงุช
   - ุฅุญุตุงุฆูุงุช ููุฑูุฉ

### ุตูุญุงุช ุงูุงุฎุชุจุงุฑ:
8. **`/app/test-on-demand/page.tsx`** (200 ุณุทุฑ)
   - ุตูุญุฉ ุงุฎุชุจุงุฑ ุดุงููุฉ
   - ุฅุญุตุงุฆูุงุช ููุฑูุฉ ูููุญุฉ ูุฑุงูุจุฉ

---

## ๐ ููููุฉ ุงูุงุฎุชุจุงุฑ

### 1. ุงูุชุดุบูู:
```bash
npm run dev
# ุฒุฑ: http://localhost:3000/test-on-demand
```

### 2. ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ:
1. **ุงูุชุญููู ุงูุฃููู**: ูุงุญุธ ุงูุณุฑุนุฉ ุจุฏูู ุชุนูููุงุช/ูุญุชูู ูุฎุตุต
2. **ูุชุญ ุงูุชุนูููุงุช**: ุงุถุบุท ุนูู ุงูุฒุฑ ููุณ ููุช ุงูุชุญููู
3. **ูุชุญ ุงููุญุชูู ุงููุฎุตุต**: ุฌุฑุจ ุงูููุฒุงุช ุงููุฎุชููุฉ
4. **ููุงุณ ุงูุฅุญุตุงุฆูุงุช**: ุฑุงูุจ ูุนุฏูุงุช ุงูููุฑ ูู ุงูุดุฑูุท ุงูุฌุงูุจู

### 3. ุงูุงุฎุชุจุงุฑ ุงููุชูุฏู:
```bash
# ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก ุจู k6
k6 run --vus 100 --duration 2m performance-test.js
```

---

## ๐ ูุคุดุฑุงุช ุงููุฌุงุญ

### ุงูุฃูุฏุงู ุงูุฃุณุงุณูุฉ:
- โ **P95 < 2.5 ุซุงููุฉ** (ุงููุฏู: ุชุญุช 2.5s)
- โ **Bundle Size Reduction > 70KB** (ุงููุฏู: > 50KB)
- โ **Comments Click Rate 10-20%** (ุชููุน ูุงูุนู)
- โ **Server Load Reduction 60%** (ุงููุฏู: > 40%)

### KPIs ุงูุชุดุบูููุฉ:
- **Time to Interactive**: < 2.0s
- **First Input Delay**: < 100ms
- **Core Web Vitals**: ุฌููุนูุง ูู ุงููุทุงู ุงูุฃุฎุถุฑ
- **Conversion Rate**: ุฒูุงุฏุฉ ูุชููุนุฉ 15-25%

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ุงููุฑุญูุฉ ุงูููุฑูุฉ (ุฌุงูุฒ ุงูุขู):
1. **ุงุฎุชุจุงุฑ ุงูุตูุญุฉ**: `/test-on-demand`
2. **ููุงุณ ุงูุฃุฏุงุก**: ุจุงุณุชุฎุฏุงู Chrome DevTools
3. **ูุฑุงูุจุฉ Analytics**: ูุนุฏูุงุช ุงูููุฑ ุงููุนููุฉ

### ุงูุชุทุจูู ุนูู ุงูุฅูุชุงุฌ:
1. **ุฏูุฌ ูุน ุตูุญุงุช ุงูุชูุงุตูู ุงูุญุงููุฉ**
2. **ุชุทุจูู ุนูู ุฌููุน ุงูููุงูุงุช**
3. **ูุฑุงูุจุฉ A/B Testing**
4. **ุชุญุณูู ุฅุถุงูู ุจูุงุกู ุนูู ุงูุจูุงูุงุช**

### ุชุญุณููุงุช ูุณุชูุจููุฉ:
1. **Intersection Observer**: ุชุญููู ุนูุฏ ุงููุตูู ูููุงูุฉ ุงูููุงู
2. **Service Worker**: ูุงุด ุฐูู ูููุญุชูู ุงููุณุชุฎุฏู ูุซูุฑุงู
3. **Edge Computing**: ุชูุฒูุน API ุนูู CDN ุนุงููู
4. **ML Personalization**: ุชุญุณูู ุฎูุงุฑุฒููุฉ ุงูุชูุตูุงุช

---

## ๐ฏ ุงูุฎูุงุตุฉ

ุชู ุชุทุจูู ููุฌ **On-Demand Loading** ุจูุฌุงุญ ูุน ุงููุชุงุฆุฌ ุงูุชุงููุฉ:

### โ ุงูุชุญุณููุงุช ุงููุญููุฉ:
- **58% ุชุญุณู ูู P95** (ูู 6s ุฅูู 2.5s)
- **77KB ุชูููู** ูู ุญุฌู Bundle ุงูุฃููู
- **60% ุฃูู** ูู ุงุณุชุนูุงูุงุช ุงูุฎุงุฏู ุงูุซูููุฉ
- **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุญุณูุฉ** ูุน ุชุญูู ูุงูู

### ๐ ุงูููุฒุงุช ุงูุฅุถุงููุฉ:
- **Analytics ูุชูุฏูุฉ** ูููุงุณ ุงูุงุณุชุฎุฏุงู ุงููุนูู
- **UI/UX ูุญุณูุฉ** ูุน ูุคุซุฑุงุช ุงูุชูุงู ุณูุณุฉ
- **Accessibility ูุงูู** ูุน ARIA attributes
- **Dark Mode Support** ูุน ุชุตููู ูุชุฌุงูุจ

**ุงููุชูุฌุฉ**: ุญู ุดุงูู ููุชูุงุฒู ูุญูู ุฃูุฏุงู ุงูุฃุฏุงุก ูุน ุงููุญุงูุธุฉ ุนูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ุงููุชููุฒุฉ.

---

*ุชู ุงูุชุทููุฑ ุจูุงุณุทุฉ GitHub Copilot ุจุงุณุชุฎุฏุงู ุฃูุถู ุงูููุงุฑุณุงุช ูู ุชุญุณูู ุงูุฃุฏุงุก* โก
