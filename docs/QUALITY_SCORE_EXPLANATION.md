# شرح نظام حساب جودة التحليلات العميقة

## المشكلة
هناك اختلاف بين نسبة الجودة التي تظهر عند توليد التحليل (مثل 55%) والنسبة المحفوظة في قاعدة البيانات (مثل 100%).

## السبب
يتم حساب الجودة في مكانين مختلفين:
1. في `lib/services/deepAnalysisService.ts` - عند توليد التحليل
2. في البيانات المحفوظة - قد تكون محسوبة بطريقة مختلفة

## معايير حساب الجودة (من 100 نقطة)

### 1. عدد الأقسام (15%)
- 10+ أقسام: 15 نقطة
- 8-9 أقسام: 12 نقطة
- 6-7 أقسام: 9 نقاط
- 4-5 أقسام: 6 نقاط
- 1-3 أقسام: 3 نقاط

### 2. طول المحتوى (25%)
- 3000+ كلمة: 25 نقطة
- 2500-2999 كلمة: 20 نقطة
- 2000-2499 كلمة: 15 نقطة
- 1500-1999 كلمة: 10 نقاط
- 1000-1499 كلمة: 5 نقاط

### 3. جودة العناوين (15%)
- عناوين منظمة ومرقمة: 15 نقطة
- عناوين منظمة فقط: 10 نقاط
- عناوين أساسية: 5 نقاط

### 4. البيانات والإحصائيات (10%)
- 7+ نقاط بيانات: 10 نقاط
- 5-6 نقاط بيانات: 8 نقاط
- 3-4 نقاط بيانات: 5 نقاط
- 1-2 نقطة بيانات: 3 نقاط

### 5. التوصيات العملية (10%)
- 8+ توصيات: 10 نقاط
- 6-7 توصيات: 8 نقاط
- 4-5 توصيات: 5 نقاط
- 1-3 توصيات: 3 نقاط

### 6. الرؤى الرئيسية (10%)
- 7+ رؤى: 10 نقاط
- 5-6 رؤى: 8 نقاط
- 3-4 رؤى: 5 نقاط
- 1-2 رؤية: 3 نقاط

### 7. ثراء المحتوى (15%)
- أقسام مفصلة (5 نقاط)
- وجود قوائم وتنسيق (3 نقاط)
- أرقام وإحصائيات في النص (4 نقاط)
- سياق سعودي (3 نقاط)

## الحل المقترح
يجب توحيد طريقة حساب الجودة في جميع أنحاء التطبيق لضمان الاتساق بين:
- القيمة المعروضة عند التوليد
- القيمة المحفوظة في قاعدة البيانات
- القيمة المعروضة في قائمة التحليلات

## ملاحظات
- يتم حساب عدد الكلمات بناءً على النص بعد إزالة علامات HTML
- يتم البحث عن الكلمات العربية والإنجليزية
- الحد الأقصى للنتيجة هو 100 نقطة 